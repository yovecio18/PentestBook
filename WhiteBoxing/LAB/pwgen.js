var length = process.argv[2];
var type = process.argv[3];

//Checking that args are not undefined
if (length === undefined || type === undefined) {
  console.log("usage: node pwgen.js <length> <type>");
  console.log("length: integer between 8 and 128");
  console.log("type: simple or complex");
}
else{
  //Sanitize args
  var type = type.replace(/[!@#$%^&*();]/g, "");
  var length = length.replace(/[!@#$%^&*();]/g, "");
}

//Checking the integer is a number
function integerCheck(length) {
  var bool = Boolean(isNaN(length));
  return bool;
}

//Checking that type is the specified type
function typeCheck(type) {
  var bool = Boolean(false);
  if  (type != "simple" && type != "complex")
  {
    bool = false;
  } 
  else{
    bool = true;
  }
  return bool;
}

//Generate the password
function generatePassword(length, type) {
  let password = "";
  let characters =
    type === "simple"
      ? "abcdefghijklmnopqrstuvwxyz"
      : "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()";

  for (let i = 0; i < length; i++) {
    password += characters.charAt(
      Math.floor(Math.random() * characters.length)
    );
  }
  console.log("%s password - length %s: %s", type, length, password);
}

try {
  if(integerCheck(length) === true || length < 8 || length > 128){
    console.log("Lenght must be an integer between 8 & 128.");
  }
  else{
    if (typeCheck(type) === false ){
      console.log("Type must be either 'simple' or 'complex'.");
    }
    else{
      generatePassword(length, type);
    }
  }
} catch (e) {
  console.log(e);
}

module.exports = {
  generatePassword,
};

