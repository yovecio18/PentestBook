This is a particular type of token used into session authorization based on JSON.


## How to identify?
https://jwt.io/


## Structure
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiSFRCIiwidmFsdWUiOjEzMzcsImFkbWluIjp0cnVlfQ.hLFaIqQc15k3ZaS7nkYL-BCBpl_dHdsBwE1aIPMd008
			(Header)									(Payload)											(Signature)

```
Where:
1)Header= token is JWT and the Algoritm used.	
```
{
  "alg": "HS256",
  "typ": "JWT"
}
```
2)Payload= this is the real aka data
```
{
  "name": "HTB",
  "value": 1337,
  "admin": true
}
```

3)Signature= used to identify sender of the message. Using the private-key of the sender+algorithm from header
```
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)
```


# Useful Tools
If you want to manipulate/hack/reads JWT tokens you can use:
https://github.com/ticarpi/jwt_tool
### Analyze
```
python3 jwt_tool/jwt_tool.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.<SNIP>
```
(This will verbose the content of the token, headers, signing, and also expiry date)
#### Forging
```
python3 jwt_tool/jwt_tool.py -X a -pc isAdmin -pv true -I eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.<SNIP>
```
(This will forge several tampered tokens
**-X a** set the alg=none aka no signing
**-pc isAdmin -pv true** add the claim **isAdmin:true** to the token body)


# Prevention
It is crucial to abide by the following items to prevent vulnerabilities in JWT-based authentication implementations:
```
    Plan and document the JWT configuration that the web application uses. This configuration includes the signature algorithm as well as which claims are used by the web application
    Do not implement custom JWT handling logic. Instead, rely on established libraries to handle JWT operations such as signature generation, signature verification, and claim extraction. Ensure that the library used is up to date.
    Tie the JWT handling logic down to suit the corresponding JWT configuration. For instance, reject tokens that are not signed with the expected signature algorithm
    If claims such as the jku claim are used, implement a whitelist of allowed hosts before fetching any data from remote origins to prevent SSRF vulnerabilities
    Always include an expiration date within the exp claim of the JWT to prevent JWTs from being valid indefinitely
```