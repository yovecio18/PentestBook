# No Signature Attack
This particular type of attack that targets SAML tokens happens when the back-end:
```
    (x) Can't assure the signature validity of the message and it authenticity=message not tampered
    (x) Can't identify the user
```
### How to attack?
Concept wise is basically same as the **"Signature-Stripping"** attack but instead to remove the signature values from the XML code, we rely on the missconfigured backend that it isn't performing a Signature validation.
This means we should be able to tamper the token without the need to re-sign it back!
1)Catch a request in Burp Repeater after a Login phase were a SAML token is returned
2)Parse the request in **Burpsuite -> Repeater -> SamlRaider**
3)Tamper the XML token to match another user 
Before:
```
<saml:Attribute Name="username" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><saml:AttributeValue xsi:type="xs:string">LEGIT</saml:AttributeValue>

```
After:
```
<saml:Attribute Name="username" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><saml:AttributeValue xsi:type="xs:string">HACKER</saml:AttributeValue>
```
4)Send back the response via **SamlRaider** (this should work if the back-end is not performing a signature check over the message thus isn't checking if the token have been tampered in the communication flow)
5)Grab the JWT token in response and get the flag!


# Signature Stripping attack
As the name tells this attack targets the SAML token by literally "stripping"  the **<ds:SignatureValue>** from the SAML token before **B64+URL** encoding back.
### Why it happens?
This attack is possible when the back-end doesn't implement a proper SAML token signature validation, and by omitting the Signature the Signature verification is not performed.
AKA= accept username without password check!

### How to perform the attack?
1)Catch a request that contains a SAML token after a login page response
2)Parse the saml token via SAML Raider extension
3)Beautify the XML code
4)Remove both the **<ds:SignatureValue>** but DO NOT remove anything else to result like:
```
<ds:SignatureValue><\ds:SignatureValue>
```
5)Tamper the SAML token example to perform a account takeover
```
<saml:Attribute Name="username" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri">
                <saml:AttributeValue xsi:type="xs:string">hackme</saml:AttributeValue>
				
```
6)Paste back in SAML Raider to perform a user takeover! 
