# What is?
Is a wire protocol that aim to be a optimized HTTP used by Apache servers to talk with Apache tomcat. Usually runs on port 8009/TCP by default.
I can be used with NGIX or Apache proxy to unveil hidden information laying back the Tomcat

## Nginx PATH
1)Download ngixns source-code:
```
wget https://nginx.org/download/nginx-1.21.3.tar.gz
tar -xzvf nginx-1.21.3.tar.gz
```
2)Compile and install the module+nginx:
```
git clone https://github.com/dvershinin/nginx_ajp_module.git
cd nginx-1.21.3
sudo apt install libpcre3-dev
./configure --add-module=`pwd`/../nginx_ajp_module --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib/nginx/modules
make
sudo make install
```
3)Point to apache apj port in `/etc/nginx/conf/nginx.conf`
```
Comment out the entire server block and append the following lines inside the http (the listen port will be the one to curl, if 80 used then try 8080 or something other)
	server <TARGET_SERVER>:8009;
	keepalive 10;
	}
server {
	listen 80;
	location / {
		ajp_keep_conn on;
		ajp_pass tomcats;
	}
}
```
4)Start nginx
```
sudo nginx
```
5)Profit
```
curl http://127.0.0.1:80
```

## Apache PATH
1)Install the APJ proxy module in Apache server
```
sudo apt install libapache2-mod-jk
sudo a2enmod proxy_ajp
sudo a2enmod proxy_http
```
2)Point the apj port in `/etc/apache2/sites-available/ajp-proxy.conf` (adapt to your need)
```
Proxy *>
Order allow,deny
Allow from all
</Proxy>
ProxyPass / ajp://$TARGET:8009/
ProxyPassReverse / ajp://$TARGET:8009/
```
3)Symlink the new modules so Apache know what is enabled
```
sudo ln -s /etc/apache2/sites-available/ajp-proxy.conf /etc/apache2/sites-enabled/ajp-proxy.conf
```
4)Start fresh Apache server
```
sudo systemctl start apache2
```
5)Profit
```
curl http://127.0.0.1:80
```