<?php
//The array to be serialized
$payload = array("id" => "3","username" => "yovecio", "role" => "2");
print("The un-serialized payload is: ");
print_r($payload);
//Serialize the payload
$serialized = serialize($payload);
print("\r\n\r\n" . "The serialized payload is: " . $serialized . "\r\n\r\n");
//Calculating the HMAC of the serialized payload
$hmac = hash_hmac('sha1', $serialized, '@pp_s3cret!!');
print("The HMAC message is: " . $hmac . "\r\n\r\n");
//B64 encoding the serialized string
$serialized_b64 = base64_encode($serialized);
print("The B64 encoded payload is: " . $serialized_b64 . "\r\n\r\n");

print("The final payload is: " . urlencode($serialized_b64) . "." . $hmac);
?>
