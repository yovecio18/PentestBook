If you need to work with the AD to do the most of the stuff you have 3 ways to make it work.

1)From Windows(https://github.com/PowerShellMafia/PowerSploit): 
```powershell-session
Import-Module .\Powerview.ps1
YOUR COMMAND HERE
```

2)From Linux(https://github.com/aniqfakhrul/powerview.py):
```
powerview range.net/lowpriv:Password123@192.168.86.192 [--dc-ip 192.168.86.192] [-k]     
```

3)Still from Windows with the *.Net* implementation (https://github.com/dmchell/SharpView)
```powershell-session
C:\>SharpView.exe Get-DomainController -Domain test.local -Server dc.test.local -Credential admin@test.local/password  
```


## Some good commands to know...
Accounts that are *AS-REPRoastable.*
```powershell-session
.\SharpView.exe Get-DomainUser -KerberosPreauthNotRequired -Properties samaccountname,useraccountcontrol,memberof
```
Users with *Kerberos Constrained Delegation.*
```powershell-session
.\SharpView.exe Get-DomainUser -TrustedToAuth -Properties samaccountname,useraccountcontrol,memberof
```
Users with *Kerberos Unconstrained Delegation.*
```powershell-session
.\SharpView.exe Get-DomainUser -LDAPFilter "(userAccountControl:1.2.840.113556.1.4.803:=524288)"
```
Check User's *description.*
```powershell-session
Get-DomainUser -Properties samaccountname,description | Where {$_.description -ne $null}
```
Get all the *SPN* available.
```powershell-session
.\SharpView.exe Get-DomainUser -SPN -Properties samaccountname,memberof,serviceprincipalname
```
Get all the users from *Foreign Groups*(users from child/parent domain that are part of groups in the current domain).
```powershell-session
Find-ForeignGroup
```
Find *Protected Groups.*
```powershell-session
.\SharpView.exe Get-DomainGroup -AdminCount
```
Find groups with *Manager assigned.*
```powershell-session
Get-DomainManagedSecurityGroup
```
Get members of *local groups* on a specific Machine.
```powershell-session
Get-NetLocalGroupMember  -ComputerName WS01 | select GroupName
```
Get Computers with *Constrain Delegation* allowed.
```powershell-session
Get-DomainComputer -TrustedToAuth | select -Property dnshostname,useraccountcontrol
```
Get Computers with *Unconstrained Constrain Delegation* allowed.
```powershell-session
.\SharpView.exe Get-DomainComputer -Unconstrained -Properties dnshostname,useraccountcontrol
```
Find specific *user's ACL.*
```powershell-session
Get-DomainObjectAcl -Identity harry.jones -Domain inlanefreight.local -ResolveGUIDs


OR specific permissions
(Get-ObjectAcl -DistinguishedName (Get-ADUser -Identity "joe.evans").DistinguishedName -ResolveGUIDs) | Where-Object { $_.ActiveDirectoryRights -match "GenericAll" } | ForEach-Object { $_ | Add-Member -MemberType NoteProperty -Name "UserName" -Value (ConvertFrom-SID $_.SecurityIdentifier) -PassThru }
```
Find *interesting ACL(generic).*
```powershell-session
Find-InterestingDomainAcl -Domain inlanefreight.local -ResolveGUIDs
```
Find all users in Domain with *DCSync* rights.
```powershell-session
Get-ObjectACL "DC=inlanefreight,DC=local" -ResolveGUIDs | ? { ($_.ActiveDirectoryRights -match 'GenericAll') -or ($_.ObjectAceType -match 'Replication-Get') } | Select-Object SecurityIdentifier | Sort-Object -Property SecurityIdentifier -Unique | ForEach-Object { $_ | Add-Member -MemberType NoteProperty -Name "UserName" -Value (ConvertFrom-SID $_.SecurityIdentifier) -PassThru }
```
List all *GPO's.*
```powershell-session
Get-DomainGPO -ComputerName WS01 | select displayname


OR specific GPO name
Get-DomainGPO -Name "Audit Policy"
```
Get Domain's policy.
```powershell-session
(Get-DomainPolicy).passwordhistorylength
```


## Reference
There are plenty of available commands, so please check the official reference on how to use & what commands are available here: [About - PowerSploit](https://powersploit.readthedocs.io/en/latest/Recon/)