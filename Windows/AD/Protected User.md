## What are?
`Protected Users` is a default Windows group used to protect users from common credential theft and lateral movement attacks. Adding users to this group will automatically enable a series of security measures:
- disables NTLM authentication
- disables the caching of DCC2 hashes
- disables the caching of clear-text passwords from the CredSSP and WDigest providers
- disables impersonation with kerberos delegation
- disables the caching of kerberos long-term encryption keys
- disables the use of DES and RC4 for kerberos authentication
- reduces kerberos ticket lifetime to four hours

## How to identify?
If you see something similar then this is the case, this means that we can't use the normal authentication.
```
┌──(root㉿kali)-[/home/user/Downloads/Infiltrator]
└─# netexec smb infiltrator.htb -u 'd.anderson' -p 'WAT?watismypass!'
SMB         10.129.65.151   445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:infiltrator.htb) (signing:True) (SMBv1:False)
SMB         10.129.65.151   445    DC01             [-] infiltrator.htb\d.anderson:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION 
```
If you have access to a snapshot of the AD you can check if directly in Bloodhound or similar; check for user membership to the group **Protected Users**.


## How to bypass?
Since the *PassTheHash* techniques can't be used for obvious reasons one way is to use Kerberos ticket instead...
```
impacket-getTGT infiltrator.htb/m.harris:'WAT?watismypass!'                  
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
[*] Saving ticket in m.harris.ccache
```
Lastly, You can use the *ccache* Kerberos ticket tot perform a *PassTheTicket* attack.